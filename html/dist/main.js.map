{"version":3,"sources":["webpack://faviconate/./src/hui/css/index.scss","webpack://faviconate/./src/hui/css/styles.css","webpack://faviconate/./src/hui/css/theme.css","webpack://faviconate/./src/index.scss","webpack://faviconate/./src/hui/css/icons/0175-floppy-disk.svg","webpack://faviconate/./src/hui/css/icons/0180-file-empty.svg","webpack://faviconate/./src/hui/css/icons/0187-folder.svg","webpack://faviconate/./src/hui/css/icons/0822-cross2.svg","webpack://faviconate/./src/hui/css/icons/0826-chevron-up.svg","webpack://faviconate/./src/hui/css/icons/0827-chevron-down.svg","webpack://faviconate/./src/hui/css/icons/0828-chevron-left.svg","webpack://faviconate/./src/hui/css/icons/0829-chevron-right.svg","webpack://faviconate/./node_modules/css-loader/dist/runtime/api.js","webpack://faviconate/./node_modules/css-loader/dist/runtime/cssWithMappingToString.js","webpack://faviconate/./node_modules/css-loader/dist/runtime/getUrl.js","webpack://faviconate/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://faviconate/./src/hui/css/index.scss?80b8","webpack://faviconate/./src/hui/css/styles.css?787b","webpack://faviconate/./src/hui/css/theme.css?1493","webpack://faviconate/./src/index.scss?7223","webpack://faviconate/./src/components/App.tsx","webpack://faviconate/./src/components/CanvasView.tsx","webpack://faviconate/./src/components/PreviewPanel.tsx","webpack://faviconate/./src/hui/helpers/ClickDismiss.tsx","webpack://faviconate/./src/hui/helpers/Color.ts","webpack://faviconate/./src/hui/helpers/FocusStackHandler.tsx","webpack://faviconate/./src/hui/helpers/KeyCaptureStackHandler.tsx","webpack://faviconate/./src/hui/helpers/Rectangle.ts","webpack://faviconate/./src/hui/helpers/errors.ts","webpack://faviconate/./src/hui/items/Button.tsx","webpack://faviconate/./src/hui/items/ColorPicker.tsx","webpack://faviconate/./src/hui/items/Icon.tsx","webpack://faviconate/./src/hui/items/Label.tsx","webpack://faviconate/./src/hui/items/MenuItem.tsx","webpack://faviconate/./src/hui/items/Range.tsx","webpack://faviconate/./src/hui/items/Separator.tsx","webpack://faviconate/./src/hui/layout/DockView.tsx","webpack://faviconate/./src/hui/layout/ToolbarView.tsx","webpack://faviconate/./src/hui/overlays/MenuOverlay.tsx","webpack://faviconate/./src/index.tsx","webpack://faviconate/./src/model/BlobComposer.ts","webpack://faviconate/./src/model/ClipboardService.ts","webpack://faviconate/./src/model/Editor.ts","webpack://faviconate/./src/model/IconCanvasController.ts","webpack://faviconate/./src/model/IconDocumentRenderer.ts","webpack://faviconate/./src/model/IconEditor.ts","webpack://faviconate/./src/model/IconService.ts","webpack://faviconate/./src/model/ImageService.ts","webpack://faviconate/./src/model/errors.ts","webpack://faviconate/./src/model/tools/EraserTool.ts","webpack://faviconate/./src/model/tools/PencilTool.ts","webpack://faviconate/./src/model/tools/SelectionTool.ts","webpack://faviconate/external \"React\"","webpack://faviconate/external \"ReactDOM\"","webpack://faviconate/webpack/bootstrap","webpack://faviconate/webpack/runtime/compat get default export","webpack://faviconate/webpack/runtime/define property getters","webpack://faviconate/webpack/runtime/hasOwnProperty shorthand","webpack://faviconate/webpack/runtime/make namespace object","webpack://faviconate/webpack/runtime/publicPath","webpack://faviconate/webpack/startup"],"names":["___CSS_LOADER_EXPORT___","push","module","id","___CSS_LOADER_URL_REPLACEMENT_0___","___CSS_LOADER_URL_REPLACEMENT_1___","___CSS_LOADER_URL_REPLACEMENT_2___","___CSS_LOADER_URL_REPLACEMENT_3___","___CSS_LOADER_URL_REPLACEMENT_4___","___CSS_LOADER_URL_REPLACEMENT_5___","___CSS_LOADER_URL_REPLACEMENT_6___","___CSS_LOADER_URL_REPLACEMENT_7___","exports","cssWithMappingToString","list","toString","this","map","item","content","concat","join","i","modules","mediaQuery","dedupe","alreadyImportedModules","length","_i","_arrayLikeToArray","arr","len","arr2","Array","_item","isArray","_arrayWithHoles","Symbol","iterator","Object","_arr","_n","_d","_e","undefined","_s","next","done","value","err","_iterableToArrayLimit","o","minLen","n","prototype","call","slice","constructor","name","from","test","_unsupportedIterableToArray","TypeError","_nonIterableRest","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","sourceURLs","sources","source","sourceRoot","url","options","__esModule","default","hash","needQuotes","replace","memo","getTarget","target","styleTarget","document","querySelector","window","HTMLIFrameElement","contentDocument","head","e","stylesInDom","getIndexByIdentifier","identifier","result","modulesToDom","idCountMap","identifiers","base","count","index","obj","css","media","sourceMap","references","updater","addStyle","insertStyleElement","style","createElement","attributes","nonce","keys","forEach","key","setAttribute","insert","Error","appendChild","textStore","replaceText","replacement","filter","Boolean","applyToSingletonTag","remove","styleSheet","cssText","cssNode","createTextNode","childNodes","removeChild","insertBefore","applyToTag","removeAttribute","firstChild","singleton","singletonCounter","update","styleIndex","bind","parentNode","removeStyleElement","newObj","all","atob","lastIdentifiers","newList","newLastIdentifiers","_index","splice","DEFAULT_ICON","makeSz","App","React","Component","props","super","state","newDocumentState","icon","controller","editor","IconService","asBlobUrl","then","setState","previews","size","newIcon","width","height","createController","selectedTool","SelectionTool","controllers","currentIcon","undos","redos","showBackground","showGrid","doc","blob","asBlobWithMime","fromFile","selectAll","dir","icons","InvalidImageError","Promise","c","current","tool","preventDefault","dataTransfer","items","file","getAsFile","importFile","console","log","copy","catch","cut","paste","r","warnings","w","success","toLowerCase","endsWith","fromIcoBlob","setIcons","EraserTool","pen","PencilTool","color","undo","undoPeek","selectionRegion","redo","redoPeek","IconCanvasController","documentSubmitted","format","downloadAs","addEventListener","focused","tagName","ctrlMeta","ctrlKey","metaKey","shiftKey","useSelection","setTimeout","useEraser","usePen","mainToolbarItems","Button","text","MenuItem","onActivate","newDocument","Separator","onClick","disabled","undoCount","redoCount","toolToolbarItems","selected","sideBar","newIconEntry","removeIconEntry","PreviewPanel","goToIcon","ColorPicker","colorPicked","colorPick","download","src","link","oldLink","getElementById","rel","href","changeFavicon","onDragOver","appDragOver","onDrop","appDrop","ToolbarView","DockView","side","sideView","CanvasView","containerRef","createRef","canvasRef","canvasSize","_cursor","resizer","updateCanvasSize","mouseUpCatcher","mouseUp","keyDownCatcher","keyDown","keyUpCatcher","keyUp","clientX","clientY","bounds","Rectangle","fromDOMRect","getBoundingClientRect","makePt","left","top","rect","pointingGestureStart","point","canvasPoint","touch","adoptCursor","body","pointingGestureEnd","removeEventListener","pointingGestureMove","cursor","touches","t","stopPropagation","ignoreKey","context","getContext","draw","render","requestAnimationFrame","prevProps","prevState","snapshot","ref","className","onMouseDown","mouseDown","onMouseMove","mouseMove","onTouchStart","touchStart","onTouchMove","touchMove","onTouchEnd","touchEnd","alt","ClickDismiss","eventName","stack","preventNext","stopImmediatePropagation","popAndExecute","m","idReminder","entry","pop","unregister","mouseup","InvalidColorFormatError","Color","g","b","a","hexColor","match","hexParsable","toDecimal","hex","parseInt","h","s","v","f","p","q","Math","max","min","round","floor","rr","gg","bb","diff","diff_c","FocusStackHandler","dismiss","commit","KeyCaptureStackHandler","execute","instance","x","y","sqrt","pow","container","scalable","wOriented","hOriented","right","bottom","rects","union","withLocation","horizontal","vertical","fromLTRB","north","northEast","east","southEast","south","southWest","west","northWest","rectangle","thisX","thisY","thisW","thisH","rectX","rectY","rectW","rectH","location","center","GraphicsMemoryError","escapeKeyDismissId","clickDismissId","buttonRef","activate","showDropDown","hideDropDown","keyDownHide","keyDownShow","keyDownActivate","keyPass","dropDownVisible","register","DOMRect","chevron","Icon","label","Label","menu","MenuOverlay","refRect","onDismissSignal","children","tags","face","classTag","tabProp","tabIndex","split","onKeyDown","ColorPickerFields","dataUrlFrom","imageData","ImageData","canvas","cx","putImageData","toDataURL","focus","txtHex","txtR","txtG","txtB","txtA","currentColor","transparent","selectedHue","type","hexRgba","hexRgb","hue","hsv","updateColor","fromHsv","alpha","dim","sat","light","where","txt","getInput","fromHex","handleChange","getInputValueFor","syncInputValues","satImg","Uint8ClampedArray","z","j","tupleInt8","createSaturationPattern","hueHandleStyle","background","hueContainerStyle","backgroundImage","hueBar","satContainerStyle","cssRgba","Range","direction","containerStyle","onChange","updateSat","handleStyle","updateHue","updateAlpha","arrayColors","fill","foo","flatArrayColors","createHuePattern","classNames","iconSize","description","showOverlay","hideOverlay","mouseActivate","sendDismissSignal","sendDismissSingleSignal","sendSelectSignal","preventNextEvent","onClose","onOpen","selectedClass","isSelected","propsWithIcon","assign","isActivated","Children","isOpen","parentMenuItem","onDismissSingleSignal","onMouseEnter","onSelectSignal","handleRef","dragging","handleOffset","mouseMoveHandler","mouseUpHandler","touchMoveHandler","touchEndHandler","handle","boundingRects","maxSpace","curSpace","refsReady","updateHandleOffset","handleOffsetX","handleOffsetY","valueFromRects","handleMouseDown","handleTouchStart","sideCss","mainCss","sideClassNames","containerClassNames","itemsCenter","itemsFar","separators","overlayRef","setOpenItem","isActivationKey","cancelAndDo","keyCaptureId","selectNext","selectPrev","openCurrentIndex","activatedIndex","selectedIndex","openIndex","find","childCount","prev","view","innerWidth","innerHeight","newRectangle","clone","withRight","withBottom","equals","st","correctPosition","menuItem","cloneElement","setNoOpenItem","closeOpenedIndex","setSelectedItem","parent","ReactDOM","offset","Blob","buffer","writeBuffer","arrayBuffer","buff","writeUint8Clamped","set","MIME_PNG","ClipboardEmptyError","mime","systemCopyBlob","systemPasteBlob","reject","ctorName","ctor","navigator","clipboard","write","read","types","indexOf","getType","NoTransactionError","TransactionInProgressError","UnsavedChangesError","_currentTransaction","_hasChanges","undoStack","redoStack","documentChanged","_document","documentState","setDocument","begin","_tool","previewBounds","empty","previewPixelSize","IconEditor","_editor","selectionSprite","resolve","ClipboardService","copyBlob","selectionBuffer","NoSelectionError","transact","cloneDocument","pasteBlob","asIcoBlob","URL","createObjectURL","click","sprite","pasteSprite","newDoc","containerRec","spriteRect","centerAt","blend","pixel","contains","deflate","pointToPixel","pixelToData","cvBounds","previewArea","pixelLength","IconDocumentRenderer","deactivate","GRID_OUT","GRID_INT","CHECKER_EVEN","CHECKER_ODD","drawBackground","drawGrid","pixelsBuffer","pixelsContext","MemoryError","checkerCanvas","localCx","CHECKER_SIZE","isTransparent","fillStyle","fillRect","createPattern","strokeStyle","strokeRect","tuple","pixelSize","drawn","rectFill","getPixelsBuffer","imageSmoothingEnabled","drawImage","ctx","beginPath","moveTo","lineTo","stroke","rectStroke","pattern","getPattern","selection","selBounds","clock","clockReminder","fives","segmentedRect","lineWidthBuffer","lineWidth","setLineDash","clearRect","inflate","renderChecker","renderPixels","renderGrid","renderFrame","renderSelection","Editor","asImageData","asCanvas","toBlob","composer","BlobComposer","pngBlobs","pngBlobSum","writeInt16LE","pngBlob","dataOffset","writeInt32LE","writeBlob","getBlob","array","iconCount","readInt16LE","dirEntryStart","dirEntry","dataSize","readInt32LE","image","ImageService","fromImage","model","getImageData","region","region32","newSize","naturalWidth","naturalHeight","resize","contain","allowScaleUp","actual","contained","scaleToContain","onPixel","spriteOffset","InvalidRegionError","d","sA","baseIndex","spriteIndex","baseR","baseG","baseB","baseA","spR","spG","spB","spA","REDUCE_MARGIN","reader","FileReader","readEvent","img","Image","FileError","readAsDataURL","reducedSize","resample","srcW","srcH","destW","destH","data2","ratio_w","ratio_h","ratio_w_half","ceil","ratio_h_half","x2","weight","weights","weights_alpha","gx_r","gx_g","gx_b","gx_a","center_y","yy","dy","abs","center_x","w0","xx","dx","NoClipboardAccessError","drawing","pointToData","newState","currentTransaction","drawAt","selecting","dragOffset","startPixel","fromIcon","isEmpty","clipOutSelection","moveSelection","implicitX","implicitY","fromSize","selectRegion","clearSelection","pixelIsInsideSelection","saveDragOffset","selectionEnded","dragEnded","updateSelRegion","updateDrag","deleteSelection","offsetSelection","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","getter","definition","defineProperty","enumerable","get","prop","hasOwnProperty","toStringTag"],"mappings":"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","file":"main.js","sourcesContent":["// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".ui-button-wrap{display:inline-flex;align-items:stretch}.ui-button-wrap.split>.split-part>.ui-icon.size-8{margin-left:0}.ui-button{display:inline-flex;align-items:center;padding:0.6em}.ui-button>.ui-icon.size-8{margin-left:0.6em}.ui-color-picker{padding:10px}.ui-color-picker .swatch{display:block;height:20px}.ui-color-picker>.layer{margin:10px 0}.ui-color-picker>.layer.slider-2d .ui-range{height:100px;background-size:100% 100px;background-repeat:no-repeat;border-radius:5px;border:solid 1px silver;background-color:blue}.ui-color-picker>.layer.slider-2d .ui-range .handle{width:5px;height:5px;border:solid 1px silver;background:white}.ui-color-picker>.layer.slider-2d .ui-range .handle:after{content:'.';color:transparent;width:40px;height:40px;background:rgba(255,255,255,0.2);position:absolute;border-radius:100%;top:-18px;left:-18px}.ui-color-picker>.layer.slider-1d .ui-range{height:10px;margin:40px 0}.ui-color-picker>.layer.slider-1d .ui-range .handle{box-shadow:0 0 0 5px white,0 3px 9px 6px rgba(0,0,0,0.5);margin-top:-14px}.ui-color-picker>.layer.slider-alpha .ui-range{height:10px;margin:40px 0}.ui-color-picker>.layer.slider-alpha .ui-range .handle{box-shadow:0 3px 4px 2px rgba(0,0,0,0.5);margin-top:-14px}.ui-clickable:not(.disabled){cursor:pointer}.ui-clickable.disabled{opacity:0.3}.ui-icon{background:center center no-repeat;background-size:100% 100%}.ui-icon.size-8{width:8px;height:8px}.ui-icon.size-16{width:16px;height:16px}.ui-icon.size-32{width:32px;height:32px}.ui-item-group{display:inline-flex;overflow:hidden;align-items:stretch}.ui-label.with-icon{display:flex;align-items:center}.ui-label.with-icon .ui-icon{margin-right:0.5em}.ui-label .desc{opacity:50%}.ui-separator{position:relative;height:1em}.ui-separator::after{display:block;position:absolute;content:'.';color:transparent;left:0;right:0;top:50%;height:1px}.ui-textbox{display:inline-flex;position:relative;border:solid 1px WindowFrame;background-color:white}.ui-textbox input{border:none;background-color:white}.ui-textbox input:focus{outline:none}.ui-menuitem{position:relative;display:flex;align-items:center;padding:0.6em;cursor:pointer}.ui-menuitem .ui-icon.icon-chevron-right{position:absolute;right:0.6em}.ui-menuitem .ui-label{padding-right:25px}.ui-tree-item{display:flex;padding:0.6em;align-items:center;cursor:pointer}.ui-tree-item>.collapse-glyph{margin-right:0.6em}.ui-range{height:40px;border-radius:20px;background:#f0f0f0;background-size:contain;position:relative}.ui-range .handle{position:absolute;width:40px;height:40px;border-radius:100%;background:Highlight}.ui-dock-view,.ui-dock-view>.dock-side,.ui-dock-view>.main-side{position:absolute;top:0;left:0;right:0;bottom:0}.ui-dock-view .dock-side,.ui-dock-view>.main-side{overflow:auto}.ui-dock-view.side-left>.dock-side{right:auto}.ui-dock-view.side-top>.dock-side{bottom:auto}.ui-dock-view.side-right>.dock-side{left:auto}.ui-dock-view.side-bottom>.dock-side{top:auto}.ui-split-view.side-left>.dock-side{border-right-style:solid;border-right-width:1px}.ui-split-view.side-top>.dock-side{border-bottom-style:solid;border-bottom-width:1px}.ui-split-view.side-right>.dock-side{border-left-style:solid;border-left-width:1px}.ui-split-view.side-bottom>.dock-side{border-top-style:solid;border-top-width:1px}.ui-tab-view>.tabs>.items>.tab{padding-left:2em;padding-right:2em}.ui-tree-view{position:absolute;top:0;left:0;right:0;bottom:0}.ui-toolbar-view>.toolbar{display:flex;justify-content:space-between}.ui-toolbar-view>.toolbar>.items{display:flex;align-items:stretch}.ui-toolbar-view>.content{flex-grow:1;overflow:auto}.ui-toolbar-view.side-left>.toolbar,.ui-toolbar-view.side-right>.toolbar{flex-direction:column}.ui-toolbar-view.side-left>.toolbar>.items,.ui-toolbar-view.side-right>.toolbar>.items{flex-direction:column}.ui-menu-overlay{min-width:100px;box-shadow:3px 3px 3px rgba(0,0,0,0.3);z-index:10000}.ui-suggestions-overlay{background-color:Menu}.ui-suggestions-overlay .ui-clickable,.ui-suggestions-overlay .ui-loader{padding:0.6em}.ui-overlay{position:fixed;z-index:10000}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/hui/items/Button.scss\",\"webpack://./src/hui/items/ColorPicker.scss\",\"webpack://./src/hui/items/Clickable.scss\",\"webpack://./src/hui/items/Icon.scss\",\"webpack://./src/hui/items/ItemGroup.scss\",\"webpack://./src/hui/items/Label.scss\",\"webpack://./src/hui/items/Separator.scss\",\"webpack://./src/hui/items/TextBox.scss\",\"webpack://./src/hui/items/MenuItem.scss\",\"webpack://./src/hui/items/TreeItem.scss\",\"webpack://./src/hui/items/Range.scss\",\"webpack://./src/hui/layout/DockView.scss\",\"webpack://./src/hui/layout/SplitView.scss\",\"webpack://./src/hui/layout/TabView.scss\",\"webpack://./src/hui/layout/TreeView.scss\",\"webpack://./src/hui/layout/ToolbarView.scss\",\"webpack://./src/hui/overlays/MenuOverlay.scss\",\"webpack://./src/hui/overlays/SuggestionsOverlay.scss\",\"webpack://./src/hui/overlays/Overlay.scss\"],\"names\":[],\"mappings\":\"AAAA,gBACE,mBAAoB,CACpB,mBAAoB,CAFtB,kDAOQ,aAAc,CACf,WAML,mBAAoB,CACpB,kBAAmB,CACnB,aAAc,CAHhB,2BAMI,iBAAkB,CACnB,iBCdD,YAAa,CANf,yBASI,aAAc,CACd,WAAY,CAVhB,wBAcI,aAAc,CAdlB,4CAmBQ,YAAa,CACb,0BAA2B,CAC3B,2BAA4B,CAC5B,iBAAkB,CAClB,uBAAwB,CACxB,qBAAsB,CAxB9B,oDA2BU,SAAU,CACV,UAAW,CACX,uBAAwB,CACxB,gBAAiB,CA9B3B,0DAiCY,WAAY,CACZ,iBAAkB,CAClB,UAAW,CACX,WAAY,CACZ,gCAAoC,CACpC,iBAAkB,CAClB,kBAAmB,CACnB,SAAU,CACV,UAAW,CAzCvB,4CAkDQ,WAhDc,CAiDd,aAhDgB,CAHxB,oDAqDU,wDAA0D,CAC1D,gBAAiB,CAtD3B,+CA6DQ,WA3Dc,CA4Dd,aA3DgB,CAHxB,uDAgEU,wCAAyC,CACzC,gBAAiB,CAClB,6BC/DL,cAAe,CAHnB,uBAOI,WAAY,CACb,SCPD,kCAAmC,CACnC,yBAA0B,CAF5B,gBAIa,SAAU,CAAG,UAAW,CAJrC,iBAKa,UAAW,CAAE,WAAY,CALtC,iBAMa,UAAW,CAAE,WAAY,CAAI,eCLxC,mBAAoB,CACpB,eAAgB,CAChB,mBAAoB,CACrB,oBCDG,YAAa,CACb,kBAAmB,CAJvB,6BAOM,kBAAmB,CAPzB,gBAYI,WAAY,CACb,cCZD,iBAAkB,CAClB,UAAW,CAFb,qBAKI,aAAc,CACd,iBAAkB,CAClB,WAAY,CACZ,iBAAkB,CAClB,MAAO,CACP,OAAQ,CACR,OAAQ,CACR,UAAW,CACZ,YCZD,mBAAoB,CACpB,iBAAkB,CAClB,4BAA6B,CAC7B,sBAAuB,CAJzB,kBAOI,WAAY,CACZ,sBAAuB,CAR3B,wBAUM,YAAa,CACd,aCVH,iBAAkB,CAClB,YAAa,CACb,kBAAmB,CACnB,aAAc,CACd,cAAe,CALjB,yCAaI,iBAAkB,CAClB,WAAY,CAdhB,uBAkBI,kBAAmB,CACpB,cClBD,YAAa,CACb,aAAc,CACd,kBAAmB,CACnB,cAAe,CAJjB,8BAOI,kBAAmB,CACpB,UCND,WAAY,CACZ,kBAAmB,CACnB,kBAAmB,CACnB,uBAAwB,CACxB,iBAAkB,CANpB,kBASI,iBAAkB,CAClB,UAAW,CACX,WAAY,CACZ,kBAAmB,CAEnB,oBAAqB,CAGtB,gECdC,iBAAkB,CAClB,KAAK,CACL,MAAM,CACN,OAAQ,CACR,QAAQ,CAPZ,kDAWI,aAAc,CAXlB,mCAc8B,UAAY,CAd1C,kCAe8B,WAAY,CAf1C,oCAgB8B,SAAY,CAhB1C,qCAiB8B,QAAY,CAAI,oCCfhB,wBAAyB,CAAE,sBAAuB,CAFhF,mCAG8B,yBAA0B,CAAE,uBAAwB,CAHlF,qCAI8B,uBAAwB,CAAE,qBAAsB,CAJ9E,sCAK8B,sBAAuB,CAAE,oBAAqB,CAAI,+BCF1E,gBAAiB,CACjB,iBAAkB,CACnB,cCJH,iBAAkB,CAClB,KAAM,CACN,MAAO,CACP,OAAQ,CACR,QAAS,CACV,0BCHG,YAAa,CACb,6BAA8B,CAJlC,iCAOM,YAAa,CACb,mBAAoB,CAR1B,0BAaI,WAAY,CACZ,aAAc,CAdlB,yEAmBM,qBAAsB,CAnB5B,uFAsBQ,qBAAsB,CACvB,iBCtBL,eAAgB,CAChB,sCAA0C,CAC1C,aAAc,CACf,wBCHC,qBAAsB,CADxB,yEAII,aAAc,CACf,YCJD,cAAe,CACf,aAAc\",\"sourcesContent\":[\".ui-button-wrap{\\n  display: inline-flex;\\n  align-items: stretch;\\n\\n  &.split {\\n    > .split-part {\\n      > .ui-icon.size-8 {\\n        margin-left: 0;\\n      }\\n    }\\n  }\\n}\\n\\n.ui-button{\\n  display: inline-flex;\\n  align-items: center;\\n  padding: 0.6em;\\n\\n  > .ui-icon.size-8{\\n    margin-left: 0.6em;\\n  }\\n}\",\".ui-color-picker{\\n\\n  $slider-height: 10px;\\n  $slider-margin: 40px 0;\\n  $handle-margin-top: -14px;\\n\\n  padding: 10px;\\n\\n  .swatch{\\n    display: block;\\n    height: 20px;\\n  }\\n\\n  > .layer{\\n    margin: 10px 0;\\n\\n    &.slider-2d{\\n\\n      .ui-range{\\n        height: 100px;\\n        background-size: 100% 100px;\\n        background-repeat: no-repeat;\\n        border-radius: 5px;\\n        border: solid 1px silver;\\n        background-color: blue;\\n\\n        .handle{\\n          width: 5px;\\n          height: 5px;\\n          border: solid 1px silver;\\n          background: white;\\n\\n          &:after{\\n            content: '.';\\n            color: transparent;\\n            width: 40px;\\n            height: 40px;\\n            background: rgba(255, 255, 255, 0.2);\\n            position: absolute;\\n            border-radius: 100%;\\n            top: -18px;\\n            left: -18px;\\n          }\\n        }\\n\\n      }\\n    }\\n\\n    &.slider-1d{\\n      .ui-range{\\n        height: $slider-height;\\n        margin: $slider-margin;\\n        .handle{\\n          box-shadow: 0 0 0 5px white, 0 3px 9px 6px rgba(0,0,0,0.5);;\\n          margin-top: -14px;\\n        }\\n      }\\n    }\\n\\n    &.slider-alpha{\\n      .ui-range{\\n        height: $slider-height;\\n        margin: $slider-margin;\\n        .handle{\\n          box-shadow: 0 3px 4px 2px rgba(0,0,0,0.5);\\n          margin-top: -14px;\\n        }\\n      }\\n    }\\n\\n  }\\n\\n}\",\".ui-clickable{\\n\\n  &:not(.disabled){\\n    cursor: pointer;\\n  }\\n\\n  &.disabled{\\n    opacity: 0.3;\\n  }\\n\\n  &.is-open,&:hover{\\n\\n  }\\n}\",\".ui-icon {\\n  background: center center no-repeat;\\n  background-size: 100% 100%;\\n\\n  &.size-8 { width: 8px;  height: 8px;  }\\n  &.size-16{ width: 16px; height: 16px; }\\n  &.size-32{ width: 32px; height: 32px; }\\n\\n}\\n\",\".ui-item-group{\\n  display: inline-flex;\\n  overflow: hidden;\\n  align-items: stretch;\\n}\",\".ui-label{\\n\\n  &.with-icon{\\n    display: flex;\\n    align-items: center;\\n\\n    .ui-icon{\\n      margin-right: 0.5em;\\n    }\\n  }\\n\\n  .desc{\\n    opacity: 50%;\\n  }\\n}\\n\",\".ui-separator{\\n  position: relative;\\n  height: 1em;\\n\\n  &::after{\\n    display: block;\\n    position: absolute;\\n    content: '.';\\n    color: transparent;\\n    left: 0;\\n    right: 0;\\n    top: 50%;\\n    height: 1px;\\n  }\\n}\",\".ui-textbox {\\n  display: inline-flex;\\n  position: relative;\\n  border: solid 1px WindowFrame;\\n  background-color: white;\\n\\n  input{\\n    border: none;\\n    background-color: white;\\n    &:focus{\\n      outline: none;\\n    }\\n  }\\n}\",\".ui-menuitem{\\n  position: relative;\\n  display: flex;\\n  align-items: center;\\n  padding: 0.6em;\\n  cursor: pointer;\\n\\n\\n  &.is-open,&:hover{\\n    /* Colors */\\n  }\\n\\n  .ui-icon.icon-chevron-right{\\n    position: absolute;\\n    right: 0.6em;\\n  }\\n\\n  .ui-label{\\n    padding-right: 25px; // Based on a 16px icon to be positioned as chevron to the right\\n  }\\n}\",\".ui-tree-item{\\n  display: flex;\\n  padding: 0.6em;\\n  align-items: center;\\n  cursor: pointer;\\n\\n  > .collapse-glyph {\\n    margin-right: 0.6em;\\n  }\\n}\\n\\n.tree-item-children{\\n}\",\".ui-range{\\n\\n  height: 40px;\\n  border-radius: 20px;\\n  background: #f0f0f0;\\n  background-size: contain;\\n  position: relative;\\n\\n  .handle{\\n    position: absolute;\\n    width: 40px;\\n    height: 40px;\\n    border-radius: 100%;\\n    //border: solid 2px Highlight;\\n    background: Highlight;\\n    //margin-top: -2px;\\n    //margin-left: -2px;\\n  }\\n\\n}\",\".ui-dock-view{\\n\\n  &, > .dock-side, > .main-side{\\n    position: absolute;\\n    top:0;\\n    left:0;\\n    right: 0;\\n    bottom:0;\\n  }\\n\\n  .dock-side, > .main-side {\\n    overflow: auto;\\n  }\\n\\n  &.side-left   > .dock-side{ right:  auto; }\\n  &.side-top    > .dock-side{ bottom: auto; }\\n  &.side-right  > .dock-side{ left:   auto; }\\n  &.side-bottom > .dock-side{ top:    auto; }\\n}\",\".ui-split-view{\\n\\n  &.side-left > .dock-side{   border-right-style: solid; border-right-width: 1px; }\\n  &.side-top > .dock-side{    border-bottom-style: solid; border-bottom-width: 1px; }\\n  &.side-right > .dock-side{  border-left-style: solid; border-left-width: 1px; }\\n  &.side-bottom > .dock-side{ border-top-style: solid; border-top-width: 1px; }\\n}\",\".ui-tab-view{\\n  > .tabs{\\n    > .items > .tab{\\n      padding-left: 2em;\\n      padding-right: 2em;\\n    }\\n  }\\n\\n}\",\".ui-tree-view{\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n}\",\".ui-toolbar-view{\\n\\n  > .toolbar{\\n    display: flex;\\n    justify-content: space-between;\\n\\n    > .items{\\n      display: flex;\\n      align-items: stretch;\\n    }\\n  }\\n\\n  > .content{\\n    flex-grow: 1;\\n    overflow: auto;\\n  }\\n\\n  &.side-left, &.side-right{\\n    > .toolbar{\\n      flex-direction: column;\\n\\n      > .items{\\n        flex-direction: column;\\n      }\\n    }\\n  }\\n\\n}\",\".ui-menu-overlay {\\n  min-width: 100px;\\n  box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.3);\\n  z-index: 10000;\\n}\",\".ui-suggestions-overlay{\\n  background-color: Menu;\\n\\n  .ui-clickable, .ui-loader{\\n    padding: 0.6em;\\n  }\\n}\",\".ui-overlay{\\n  position: fixed;\\n  z-index: 10000;\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_GET_URL_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/getUrl.js\";\nimport ___CSS_LOADER_URL_IMPORT_0___ from \"./icons/0822-cross2.svg\";\nimport ___CSS_LOADER_URL_IMPORT_1___ from \"./icons/0175-floppy-disk.svg\";\nimport ___CSS_LOADER_URL_IMPORT_2___ from \"./icons/0180-file-empty.svg\";\nimport ___CSS_LOADER_URL_IMPORT_3___ from \"./icons/0187-folder.svg\";\nimport ___CSS_LOADER_URL_IMPORT_4___ from \"./icons/0826-chevron-up.svg\";\nimport ___CSS_LOADER_URL_IMPORT_5___ from \"./icons/0827-chevron-down.svg\";\nimport ___CSS_LOADER_URL_IMPORT_6___ from \"./icons/0828-chevron-left.svg\";\nimport ___CSS_LOADER_URL_IMPORT_7___ from \"./icons/0829-chevron-right.svg\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\nvar ___CSS_LOADER_URL_REPLACEMENT_0___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_0___);\nvar ___CSS_LOADER_URL_REPLACEMENT_1___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_1___);\nvar ___CSS_LOADER_URL_REPLACEMENT_2___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_2___);\nvar ___CSS_LOADER_URL_REPLACEMENT_3___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_3___);\nvar ___CSS_LOADER_URL_REPLACEMENT_4___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_4___);\nvar ___CSS_LOADER_URL_REPLACEMENT_5___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_5___);\nvar ___CSS_LOADER_URL_REPLACEMENT_6___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_6___);\nvar ___CSS_LOADER_URL_REPLACEMENT_7___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_7___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"body{font:caption}.ui-panel>div{margin:50px}.ui-icon.icon-cross{background-image:url(\" + ___CSS_LOADER_URL_REPLACEMENT_0___ + \")}.ui-icon.icon-floppy{background-image:url(\" + ___CSS_LOADER_URL_REPLACEMENT_1___ + \")}.ui-icon.icon-file{background-image:url(\" + ___CSS_LOADER_URL_REPLACEMENT_2___ + \")}.ui-icon.icon-folder{background-image:url(\" + ___CSS_LOADER_URL_REPLACEMENT_3___ + \")}.ui-icon.icon-chevron-up{background-image:url(\" + ___CSS_LOADER_URL_REPLACEMENT_4___ + \")}.ui-icon.icon-chevron-down{background-image:url(\" + ___CSS_LOADER_URL_REPLACEMENT_5___ + \")}.ui-icon.icon-chevron-left{background-image:url(\" + ___CSS_LOADER_URL_REPLACEMENT_6___ + \")}.ui-icon.icon-chevron-right{background-image:url(\" + ___CSS_LOADER_URL_REPLACEMENT_7___ + \")}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/hui/css/styles.css\"],\"names\":[],\"mappings\":\"AAAA,KACI,YAAa,CAChB,cAGG,WAAY,CAEf,oBAEqB,wDAA8C,CAAI,qBACjD,wDAAmD,CAAI,mBACzD,wDAAkD,CAAI,qBACpD,wDAA8C,CAAI,yBAC9C,wDAAkD,CAAI,2BACpD,wDAAoD,CAAI,2BACxD,wDAAoD,CAAI,4BACvD,wDAAqD\",\"sourcesContent\":[\"body{\\n    font: caption;\\n}\\n\\n.ui-panel > div {\\n    margin: 50px;\\n    /*box-shadow: 0 0 0 3px blue;*/\\n}\\n\\n.ui-icon.icon-cross { background-image: url(\\\"icons/0822-cross2.svg\\\"); }\\n.ui-icon.icon-floppy { background-image: url(\\\"icons/0175-floppy-disk.svg\\\"); }\\n.ui-icon.icon-file { background-image: url(\\\"icons/0180-file-empty.svg\\\"); }\\n.ui-icon.icon-folder { background-image: url(\\\"icons/0187-folder.svg\\\"); }\\n.ui-icon.icon-chevron-up { background-image: url(\\\"icons/0826-chevron-up.svg\\\"); }\\n.ui-icon.icon-chevron-down { background-image: url(\\\"icons/0827-chevron-down.svg\\\"); }\\n.ui-icon.icon-chevron-left { background-image: url(\\\"icons/0828-chevron-left.svg\\\"); }\\n.ui-icon.icon-chevron-right { background-image: url(\\\"icons/0829-chevron-right.svg\\\"); }\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".ui-clickable.is-open{background-color:Highlight;color:HighlightText}.ui-button-wrap.split:hover>.ui-button-split-part,.ui-button-wrap.split:hover>.ui-button,.ui-button:hover:not(.face-never):not(.disabled),.ui-clickable.selected:not(.disabled),.ui-button.is-open{background-color:Highlight;color:HighlightText}.ui-menuitem.is-open,.ui-menuitem.is-selected{background-color:Highlight;color:HighlightText}.ui-menu-overlay,.ui-suggestions-overlay{background-color:Window;color:WindowText;border:solid 1px #ddd;box-shadow:2px 2px 2px rgba(0,0,0,0.2)}.ui-separator:after{background-color:rgba(0,0,0,0.13)}.ui-item-group{border:solid 1px #ddd;border-radius:0.5em}.ui-item-group>.ui-clickable.selected:not(.disabled){background-color:#ddd}.ui-split-view>.dock-side{border-color:#ddd}.ui-tab-view>.tabs{background-color:#ddd}.ui-tab-view>.tabs>.items>.tab{margin-top:0.6em}.ui-tab-view>.tabs>.items>.selected{background-color:white}.ui-tree-view:focus .ui-tree-item.selected{background-color:Highlight;color:HighlightText}.ui-tree-item.selected{background-color:#f0f0f0;color:HighlightText}.ui-tree-item:not(.selected):hover{background-color:#E3EFFE}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/hui/css/theme.css\"],\"names\":[],\"mappings\":\"AAAA,sBACI,0BAA2B,CAC3B,mBAAoB,CACvB,mMAOG,0BAA2B,CAC3B,mBAAoB,CACvB,8CAIG,0BAA2B,CAC3B,mBAAoB,CACvB,yCAIG,uBAAwB,CACxB,gBAAiB,CACjB,qBAAsB,CACtB,sCAA0C,CAC7C,oBAGG,iCAAqC,CACxC,eAEG,qBAAsB,CACtB,mBAAoB,CACvB,qDAGG,qBAAsB,CACzB,0BAE4B,iBAAkB,CAAK,mBAE7B,qBAAsB,CAAG,+BACT,gBAAiB,CAAG,oCACf,sBAAuB,CAAI,2CAGnE,0BAA2B,CAC3B,mBAAoB,CACvB,uBAGG,wBAAyB,CACzB,mBAAoB,CACvB,mCAGG,wBAAyB\",\"sourcesContent\":[\".ui-clickable.is-open{\\n    background-color: Highlight;\\n    color: HighlightText;\\n}\\n\\n.ui-button-wrap.split:hover > .ui-button-split-part,\\n.ui-button-wrap.split:hover > .ui-button,\\n.ui-button:hover:not(.face-never):not(.disabled),\\n.ui-clickable.selected:not(.disabled),\\n.ui-button.is-open{\\n    background-color: Highlight;\\n    color: HighlightText;\\n}\\n\\n.ui-menuitem.is-open,\\n.ui-menuitem.is-selected{\\n    background-color: Highlight;\\n    color: HighlightText;\\n}\\n\\n.ui-menu-overlay,\\n.ui-suggestions-overlay{\\n    background-color: Window;\\n    color: WindowText;\\n    border: solid 1px #ddd;\\n    box-shadow: 2px 2px 2px rgba(0, 0, 0, 0.2);\\n}\\n\\n.ui-separator:after{\\n    background-color: rgba(0, 0, 0, 0.13);\\n}\\n.ui-item-group{\\n    border: solid 1px #ddd;\\n    border-radius: 0.5em;\\n}\\n\\n.ui-item-group > .ui-clickable.selected:not(.disabled){\\n    background-color: #ddd;\\n}\\n\\n.ui-split-view > .dock-side{ border-color: #ddd;  }\\n\\n.ui-tab-view > .tabs { background-color: #ddd;}\\n.ui-tab-view > .tabs  > .items > .tab {margin-top: 0.6em;}\\n.ui-tab-view > .tabs  > .items > .selected{ background-color: white; }\\n\\n.ui-tree-view:focus .ui-tree-item.selected{\\n    background-color: Highlight;\\n    color: HighlightText;\\n}\\n\\n.ui-tree-item.selected{\\n    background-color: #f0f0f0;\\n    color: HighlightText;\\n}\\n\\n.ui-tree-item:not(.selected):hover{\\n    background-color: #E3EFFE;\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"div.canvas-view{position:absolute;top:0;left:0;right:0;bottom:0}div.canvas-view canvas:focus{outline:none}.preview-panel{border-left:4px solid transparent}.preview-panel.selected{border-left-color:Highlight}#app{position:absolute;top:0;left:0;right:0;bottom:0}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/CanvasView.scss\",\"webpack://./src/components/PreviewPanel.scss\",\"webpack://./src/components/App.scss\"],\"names\":[],\"mappings\":\"AAAA,gBAEE,iBAAkB,CAClB,KAAM,CAAE,MAAO,CAAE,OAAQ,CAAE,QAAQ,CAHrC,6BAMI,YAAa,CACd,eCLD,iCAAkC,CAFpC,wBAKI,2BAA4B,CAC7B,KCLD,iBAAkB,CAClB,KAAM,CACN,MAAO,CACP,OAAQ,CACR,QAAS\",\"sourcesContent\":[\"div.canvas-view{\\n\\n  position: absolute;\\n  top: 0; left: 0; right: 0; bottom:0;\\n\\n  canvas:focus{\\n    outline: none;\\n  }\\n\\n}\",\".preview-panel{\\n\\n  border-left: 4px solid transparent;\\n\\n  &.selected{\\n    border-left-color: Highlight;\\n  }\\n\\n}\",\"#app{\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","export default __webpack_public_path__ + \"images/eaa6b0d5c4b755a1c5f442a5b31d3913.svg\";","export default __webpack_public_path__ + \"images/1c7c2677071e811d4aca7f0b4a48fbb3.svg\";","export default __webpack_public_path__ + \"images/ae2087a3922088a93b0f3fde77c0e56f.svg\";","export default __webpack_public_path__ + \"images/bb9f1f8d917fff10d0587496ee1e8cfd.svg\";","export default __webpack_public_path__ + \"images/38aee18e86f51b62ad5e548bd745488d.svg\";","export default __webpack_public_path__ + \"images/384b04f25826b885bb36dbf1d2d847c1.svg\";","export default __webpack_public_path__ + \"images/16d86ed52ad1cc4fa6e0eb00d1794003.svg\";","export default __webpack_public_path__ + \"images/12f0f97012b8956a484acfdd52300568.svg\";","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nmodule.exports = function cssWithMappingToString(item) {\n  var _item = _slicedToArray(item, 4),\n      content = _item[1],\n      cssMapping = _item[3];\n\n  if (typeof btoa === 'function') {\n    // eslint-disable-next-line no-undef\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || '').concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n};","\"use strict\";\n\nmodule.exports = function (url, options) {\n  if (!options) {\n    // eslint-disable-next-line no-param-reassign\n    options = {};\n  } // eslint-disable-next-line no-underscore-dangle, no-param-reassign\n\n\n  url = url && url.__esModule ? url.default : url;\n\n  if (typeof url !== 'string') {\n    return url;\n  } // If url is already wrapped in quotes, remove them\n\n\n  if (/^['\"].*['\"]$/.test(url)) {\n    // eslint-disable-next-line no-param-reassign\n    url = url.slice(1, -1);\n  }\n\n  if (options.hash) {\n    // eslint-disable-next-line no-param-reassign\n    url += options.hash;\n  } // Should url be wrapped?\n  // See https://drafts.csswg.org/css-values-3/#urls\n\n\n  if (/[\"'() \\t\\n]/.test(url) || options.needQuotes) {\n    return \"\\\"\".concat(url.replace(/\"/g, '\\\\\"').replace(/\\n/g, '\\\\n'), \"\\\"\");\n  }\n\n  return url;\n};","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","import api from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js!./index.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import api from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js!./styles.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import api from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js!./theme.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import api from \"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../node_modules/css-loader/dist/cjs.js!../node_modules/sass-loader/dist/cjs.js!./index.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import * as React from \"react\";\nimport {ToolbarView} from \"../hui/layout/ToolbarView\";\nimport {Button} from \"../hui/items/Button\";\nimport {Separator} from \"../hui/items/Separator\";\nimport {DockView} from \"../hui/layout/DockView\";\nimport {CanvasView} from \"./CanvasView\";\nimport {DownloadFormat, IconCanvasController} from \"../model/IconCanvasController\";\nimport {EraserTool} from \"../model/tools/EraserTool\";\nimport {PencilTool} from \"../model/tools/PencilTool\";\nimport {Color} from \"../hui/helpers/Color\";\nimport {ColorPicker} from \"../hui/items/ColorPicker\";\nimport {PreviewPanel} from \"./PreviewPanel\";\nimport {IconDocument, IconEditorTool} from \"../model/IconEditor\";\nimport {SelectionTool} from \"../model/tools/SelectionTool\";\nimport {IconDirectory, IconService} from \"../model/IconService\";\nimport {MenuItem} from \"../hui/items/MenuItem\";\nimport {makeSz, Size} from \"../hui/helpers/Rectangle\";\nimport {InvalidImageError} from \"../model/errors\";\n\nconst DEFAULT_ICON = makeSz(32, 32);\n\nfunction changeFavicon(src: string) {\n    const link = document.createElement('link'),\n        oldLink = document.getElementById('dynamic-favicon');\n    link.id = 'dynamic-favicon';\n    link.rel = 'shortcut icon';\n    link.href = src;\n    if (oldLink) {\n        document.head.removeChild(oldLink);\n    }\n    document.head.appendChild(link);\n}\n\nexport interface AppProps{}\n\nexport interface AppState{\n    controller: IconCanvasController;\n    controllers: IconCanvasController[];\n    previews: string[];\n    selectedTool: IconEditorTool | null;\n    currentIcon: number;\n    undos: number;\n    redos: number;\n    showBackground: boolean;\n    showGrid: boolean;\n}\n\nexport class App extends React.Component<AppProps, AppState>{\n\n    constructor(props: AppProps) {\n        super(props);\n\n        this.state = this.newDocumentState(DEFAULT_ICON);\n\n        const icon = this.state.controller.editor.document.icon;\n\n        IconService.asBlobUrl(icon).then(data => this.setState({previews: [data]}));\n\n    }\n\n    private newDocumentState(size: Size): AppState{\n        const icon = IconService.newIcon(size.width, size.height);\n        const controller = this.createController({icon});\n        const selectedTool = new SelectionTool(controller);\n\n        return {\n            controller,\n            selectedTool,\n            controllers: [controller],\n            currentIcon: 0,\n            previews: [],\n            undos: 0,\n            redos: 0,\n            showBackground: true,\n            showGrid: true,\n        }\n    }\n\n    private newDocument(size: number){\n\n        const icon = IconService.newIcon(size, size)\n        const doc = {icon};\n        const controller = this.createController(doc);\n\n        this.setState({\n            controller,\n            controllers: [controller],\n            previews: [],\n            selectedTool: new SelectionTool(controller)\n        });\n    }\n\n    private async newIconEntry(size: number){\n\n        const blob = await IconService.asBlobWithMime(this.state.controller.editor.document.icon );\n        const icon = await IconService.fromFile(blob, makeSz(size, size), true);\n        const doc = {icon};\n        const controller = this.createController(doc);\n        const selectedTool = new SelectionTool(controller);\n        const controllers = [...this.state.controllers, controller];\n        const currentIcon = controllers.length - 1;\n\n        (selectedTool as SelectionTool).selectAll();\n\n        IconService.asBlobUrl(icon).then(data => {\n\n            const previews = [...this.state.previews, data];\n            this.setState({\n                controller,\n                controllers,\n                selectedTool,\n                currentIcon,\n                previews\n            });\n        })\n    }\n\n    private setIcons(dir: IconDirectory){\n\n        if (dir.icons.length == 0){\n            throw new InvalidImageError();\n        }\n\n        const controllers = dir.icons.map(icon => this.createController({icon}));\n        const currentIcon = 0;\n        const controller = controllers[0];\n        const selectedTool = new SelectionTool(controller);\n\n        Promise.all(controllers.map(c => IconService.asBlobUrl(c.editor.document.icon)))\n            .then(previews => {\n                this.setState({\n                    controller,\n                    controllers,\n                    selectedTool,\n                    currentIcon,\n                    previews\n                });\n            });\n    }\n\n    private removeIconEntry(){\n\n        let current = this.state.currentIcon;\n        let controllers = this.state.controllers.filter((item, i) => i !== current);\n        let previews = this.state.previews.filter((item, i) => i !== current);\n        let controller: IconCanvasController;\n        let currentIcon = 0;\n\n        if (controllers.length == 0){\n            controller =this.createController({icon: IconService.newIcon(DEFAULT_ICON.width, DEFAULT_ICON.height)});\n            controllers = [controller];\n            const selectedTool = new SelectionTool(controller)\n\n            IconService.asBlobUrl(controller.editor.document.icon)\n                .then(data => {\n                    this.setState({\n                        controllers, controller, currentIcon, selectedTool, previews: [data]\n                    })\n                });\n\n        }else{\n\n            controller = controllers[currentIcon];\n\n            this.setState({\n                controllers, controller, currentIcon, previews, selectedTool: controller.tool\n            });\n        }\n\n\n    }\n\n    private appDragOver(e: React.DragEvent<HTMLDivElement>){\n        e.preventDefault();\n    }\n\n    private appDrop(e: React.DragEvent<HTMLDivElement>){\n        e.preventDefault();\n\n        if (e.dataTransfer.items){\n            for (let i = 0; i < e.dataTransfer.items.length; i++){\n                const item = e.dataTransfer.items[i];\n                const file = item.getAsFile();\n\n                if (file){\n                    this.importFile(file);\n                }else{\n                    console.log(`Can't get as file`)\n                }\n\n                break;\n            }\n        }else{\n            console.log(`No transfer items`)\n        }\n\n    }\n\n    private copy(){\n        this.state.controller.copy()\n            .then(() => console.log(\"Copied\"))\n            .catch(e => console.log(`Not copied: ${e}`));\n    }\n\n    private cut(){\n        this.state.controller.cut()\n            .then(() => console.log(\"Did cut\"))\n            .catch(e => console.log(`Didn't cut: ${e}`));\n    }\n\n    private paste(){\n        this.state.controller.paste()\n            .then(r => {\n\n                console.log(`Pasted`);\n\n                if (r.warnings.length > 0){\n                    console.log(` - Warnings: ${r.warnings.length}`);\n                    r.warnings.forEach(w => console.log(`   - ${w}`))\n                }\n\n                if (r.success && r.tool){\n                    this.setState({selectedTool: r.tool});\n                }\n\n            })\n            .catch(e => console.log(`Not pasted: ${e}`));\n    }\n\n    private importFile(file: File){\n        if (file.name.toLowerCase().endsWith('.ico')){\n            IconService.fromIcoBlob(file)\n                .then(dir => this.setIcons(dir))\n                .catch(e => console.log(`Can't open ico file: ${e}`));\n        }else{\n            this.state.controller.importFile(file)\n                .then(selectedTool => this.setState({selectedTool}));\n        }\n    }\n\n    private useEraser(){\n        this.setState({selectedTool: new EraserTool(this.state.controller)});\n    }\n\n    private usePen(){\n        const pen = new PencilTool(this.state.controller);\n        this.setState({selectedTool: pen});\n\n    }\n\n    private useSelection(){\n        this.setState({selectedTool: new SelectionTool(this.state.controller)});\n    }\n\n    private colorPick(color: Color){\n        if (this.state.controller.tool instanceof PencilTool){\n            const p: PencilTool = this.state.controller.tool as PencilTool;\n            p.color = color;\n        }\n    }\n\n    private undo(){\n        this.state.controller.editor.undo();\n        const undos = this.state.undos + 1;\n\n        if (this.state.controller.editor.undoPeek?.selectionRegion && !(this.state.selectedTool instanceof SelectionTool)){\n            this.setState({undos, selectedTool: new SelectionTool(this.state.controller)});\n        }else{\n            this.setState({undos});\n        }\n\n    }\n\n    private redo(){\n        this.state.controller.editor.redo();\n        const redos = this.state.redos + 1;\n\n        if (this.state.controller.editor.redoPeek?.selectionRegion && !(this.state.selectedTool instanceof SelectionTool)){\n            this.setState({redos, selectedTool: new SelectionTool(this.state.controller)});\n        }else{\n            this.setState({redos});\n        }\n    }\n\n    private createController(doc: IconDocument): IconCanvasController{\n\n        const controller = new IconCanvasController(doc);\n\n        controller.editor.documentSubmitted = () => {\n\n            const previews = [...this.state.previews];\n            const icon = this.state.controller.editor.document.icon;\n\n            IconService.asBlobUrl(icon).then(data => {\n                previews[this.state.currentIcon] = data;\n                this.setState({previews});\n            });\n        };\n\n        return controller;\n    }\n\n    private goToIcon(currentIcon: number){\n\n        const controller = this.state.controllers[currentIcon];\n        const selectedTool = controller.tool;\n\n        this.setState({controller, currentIcon, selectedTool});\n    }\n\n    private download(format: DownloadFormat){\n        this.state.controller.downloadAs(format, this.state.controllers.map(c => c.editor.document.icon))\n            .then(() => console.log(`Download triggered`));\n    }\n\n    componentDidMount() {\n        document.addEventListener('keydown', e => {\n\n            const focused = document.querySelector(\"*:focus\");\n\n            if (focused && (focused.tagName == 'INPUT' || focused.tagName == 'TEXTAREA')){\n                return;\n            }\n\n            const ctrlMeta = e.ctrlKey || e.metaKey;\n\n            if (e.key == 'z' && ctrlMeta && e.shiftKey){\n                this.redo();\n                e.preventDefault();\n\n            }else if(e.key == 'z' && ctrlMeta){\n                this.undo();\n                e.preventDefault();\n\n            }else if(e.key === 'v' && !ctrlMeta){\n                this.useSelection();\n                e.preventDefault();\n\n            }else if((e.key === 'p' || e.key == 'd') && !ctrlMeta){\n                this.usePen();\n                e.preventDefault();\n\n            }else if(e.key === 'e' && !ctrlMeta){\n                this.useEraser();\n                e.preventDefault();\n\n            }else if(e.key === 'b' && !ctrlMeta){\n                this.setState({showBackground: !this.state.showBackground});\n                e.preventDefault();\n\n            }else if(e.key === 'g' && !ctrlMeta){\n                this.setState({showGrid: !this.state.showGrid});\n                e.preventDefault();\n\n            }else if(e.key === 'c' && ctrlMeta){\n                this.copy();\n                e.preventDefault();\n\n            }else if(e.key === 'v' && ctrlMeta){\n                this.paste();\n                e.preventDefault();\n\n            }else if(e.key === 'x' && ctrlMeta){\n                this.cut();\n                e.preventDefault();\n\n            }else if(e.key === 'a' && ctrlMeta){\n                if (!(this.state.selectedTool instanceof SelectionTool)){\n                    this.useSelection();\n                }\n                setTimeout(() => (this.state.selectedTool as SelectionTool).selectAll());\n                e.preventDefault();\n\n            }\n\n        });\n    }\n\n    render() {\n\n        const controller = this.state.controller;\n\n        const mainToolbarItems = <>\n            <Button text={`Faviconate`}>\n                <MenuItem text={`New 16x16 Icon`} onActivate={() => this.newDocument(16)}/>\n                <MenuItem text={`New 32x32 Icon`} onActivate={() => this.newDocument(32)}/>\n                <MenuItem text={`New 64x64 Icon`} onActivate={() => this.newDocument(64)}/>\n                <MenuItem text={`New 128x128 Icon`} onActivate={() => this.newDocument(128)}/>\n                <MenuItem text={`New 256x256 Icon`} onActivate={() => this.newDocument(256)}/>\n            </Button>\n            <Separator/>\n            <Button text={`Undo`} onClick={() => this.undo()} disabled={controller.editor.undoCount == 0}/>\n            <Button text={`Redo`} onClick={() => this.redo()} disabled={controller.editor.redoCount == 0}/>\n            <Button text={`Cut`} onClick={() => this.cut()}/>\n            <Button text={`Copy`} onClick={() => this.copy()}/>\n            <Button text={`Paste`} onClick={() => this.paste()}/>\n        </>;\n\n        const toolToolbarItems = <>\n            <Button\n                text={`Sel`}\n                onClick={() => this.useSelection()}\n                selected={this.state.selectedTool instanceof SelectionTool}\n            />\n            <Button\n                text={`Pen`}\n                onClick={() => this.usePen()}\n                selected={this.state.selectedTool instanceof PencilTool && !(this.state.selectedTool instanceof EraserTool)}\n            />\n            <Button\n                text={`Ers`}\n                onClick={() => this.useEraser()}\n                selected={this.state.selectedTool instanceof EraserTool}/>\n            <Button\n                text={`Bg`}\n                onClick={() => this.setState({showBackground: !this.state.showBackground})}\n                selected={this.state.showBackground}\n            />\n            <Button\n                text={`Gr`}\n                onClick={() => this.setState({showGrid: !this.state.showGrid})}\n                selected={this.state.showGrid}\n            />\n        </>;\n\n        const sideBar = <>\n            <Button text={`+`} onClick={() => this.newIconEntry(16)}>\n                <MenuItem text={`16 x 16`} onActivate={() => this.newIconEntry(16)}/>\n                <MenuItem text={`32 x 32`} onActivate={() => this.newIconEntry(32)}/>\n                <MenuItem text={`64 x 64`} onActivate={() => this.newIconEntry(64)}/>\n                <MenuItem text={`128 x 128`} onActivate={() => this.newIconEntry(128)}/>\n                <MenuItem text={`256 x 256`} onActivate={() => this.newIconEntry(256)}/>\n            </Button>\n            <Button text={`-`} disabled={this.state.controllers.length === 0} onClick={() => this.removeIconEntry()}/>\n            <div>\n                {this.state.previews.map((item, index) => (\n                    <PreviewPanel\n                        key={item}\n                        data={item}\n                        selected={index === this.state.currentIcon}\n                        onActivate={() => this.goToIcon(index)}/>\n                ))}\n            </div>\n            <ColorPicker colorPicked={color => this.colorPick(color) } />\n            <Button text={`PNG`} onClick={() => this.download('png')}/>\n            <Button text={`ICO`} onClick={() => this.download('ico')}/>\n        </>;\n\n        if (this.state.previews[this.state.currentIcon]){\n            changeFavicon(this.state.previews[this.state.currentIcon]);\n        }\n\n        controller.tool = this.state.selectedTool;\n        controller.showBackground = this.state.showBackground;\n        controller.showGrid = this.state.showGrid;\n\n        return (\n            <div id={`app`}\n                 onDragOver={e => this.appDragOver(e)}\n                 onDrop={e => this.appDrop(e)}\n            >\n            <ToolbarView items={mainToolbarItems}>\n                <DockView side={`right`} sideView={sideBar}>\n                    <ToolbarView side={`left`} items={toolToolbarItems}>\n                        <CanvasView controller={controller} />\n                    </ToolbarView>\n                </DockView>\n            </ToolbarView>\n            </div>\n        );\n    }\n\n}","import * as React from \"react\";\nimport {RefObject} from \"react\";\nimport {makePt, makeSz, Point, Rectangle, Size} from \"../hui/helpers/Rectangle\";\n\nexport interface PointingEvent {\n    point: Point;\n    touch: boolean;\n}\n\nexport interface PointingEventResult{\n    cursor?: string;\n}\n\nexport interface KeyEvent{\n    key: string;\n}\n\nexport interface KeyEventResult{\n    preventDefault?: boolean;\n}\n\nexport interface CanvasSensor{\n    pointingGestureMove?     (e: PointingEvent):    PointingEventResult | void;\n    pointingGestureStart?    (e: PointingEvent):    PointingEventResult | void;\n    pointingGestureEnd?      (e: PointingEvent):    PointingEventResult | void;\n    keyDown?                 (e: KeyEvent):         KeyEventResult | void;\n    keyUp?                   (e: KeyEvent):         KeyEventResult | void;\n}\n\nexport interface CanvasViewController extends CanvasSensor{\n    render                   (context: CanvasRenderingContext2D, size: Size): void;\n}\n\nexport interface CanvasViewProps{\n    controller: CanvasViewController;\n}\n\nexport class CanvasView extends React.Component<CanvasViewProps>{\n\n    readonly containerRef: RefObject<HTMLDivElement> = React.createRef();\n    readonly canvasRef: RefObject<HTMLCanvasElement> = React.createRef();\n\n    private canvasSize: Size = makeSz(0,0);\n    private _cursor: string | null = null;\n    private resizer = () => this.updateCanvasSize();\n    private mouseUpCatcher = (e: MouseEvent) => this.mouseUp(e);\n    private keyDownCatcher = (e: KeyboardEvent) => this.keyDown(e);\n    private keyUpCatcher = (e: KeyboardEvent) => this.keyUp(e);\n\n    constructor(props: CanvasViewProps) {\n        super(props);\n\n    }\n\n    private canvasPoint(clientX: number, clientY: number): Point{\n        if(this.canvasRef.current) {\n            const bounds = Rectangle.fromDOMRect(this.canvasRef.current.getBoundingClientRect());\n            return makePt(clientX - bounds.left, clientY - bounds.top);\n        }\n        return makePt(clientX, clientY);\n    }\n\n    private updateCanvasSize(){\n        if(this.containerRef.current) {\n\n            const rect = Rectangle.fromDOMRect(this.containerRef.current.getBoundingClientRect());\n\n            if(this.canvasRef.current) {\n                this.canvasSize = makeSz(rect.width, rect.height);\n                this.canvasRef.current.width = rect.width;\n                this.canvasRef.current.height = rect.height;\n\n            }else{\n                console.log(`Diagram::resize: No canvasRef`);\n            }\n\n        }else{\n            console.log(`Diagram::resize: No containerRef`);\n        }\n\n    }\n\n    private mouseDown(e: React.MouseEvent<HTMLCanvasElement, MouseEvent>){\n\n        if (this.controller.pointingGestureStart){\n            const point = this.canvasPoint(e.clientX, e.clientY);\n            const result = this.controller.pointingGestureStart({point, touch: false});\n\n            this.adoptCursor(result);\n        }\n\n        document.body.addEventListener('mouseup', this.mouseUpCatcher);\n\n    }\n\n    private mouseUp(e: MouseEvent){\n\n        if(this.canvasRef.current && this.controller.pointingGestureEnd) {\n            const point = this.canvasPoint(e.clientX, e.clientY);\n            const result = this.controller.pointingGestureEnd({point, touch: false});\n\n            this.adoptCursor(result);\n        }\n\n        document.body.removeEventListener(`mouseup`, this.mouseUpCatcher);\n    }\n\n    private mouseMove(e: React.MouseEvent<HTMLCanvasElement, MouseEvent>){\n\n        if (this.controller.pointingGestureMove){\n            const point = this.canvasPoint(e.clientX, e.clientY);\n            const result = this.controller.pointingGestureMove({point, touch: false});\n\n            this.adoptCursor(result);\n        }\n    }\n\n    private adoptCursor(result: PointingEventResult | void){\n        if (result && result.cursor){\n            this.cursor = result.cursor;\n        }else{\n            this.cursor = 'default';\n        }\n    }\n\n    private touchEnd(e: React.TouchEvent<HTMLCanvasElement>){\n        if (this.controller.pointingGestureEnd){\n            if(e.touches.length > 0) {\n                const t = e.touches[0];\n                this.controller.pointingGestureEnd({\n                    point: this.canvasPoint(t.clientX, t.clientY),\n                    touch: true,\n                });\n            }else{\n                this.controller.pointingGestureEnd({point: makePt(0,0), touch: true})\n            }\n        }\n    }\n\n    private touchMove(e: React.TouchEvent<HTMLCanvasElement>){\n        if(this.controller.pointingGestureMove && e.touches.length > 0) {\n            const t = e.touches[0];\n            this.controller.pointingGestureMove({\n                point: this.canvasPoint(t.clientX, t.clientY),\n                touch: true\n            });\n        }\n    }\n\n    private touchStart(e: React.TouchEvent<HTMLCanvasElement>){\n        if(this.controller.pointingGestureStart && e.touches.length > 0) {\n            e.preventDefault();\n            e.stopPropagation();\n            const t = e.touches[0];\n            const point = this.canvasPoint(t.clientX, t.clientY);\n            this.controller.pointingGestureStart({point, touch: true});\n        }\n\n    }\n\n    private ignoreKey(): boolean{\n        const focused = document.querySelector(\"*:focus\");\n\n        return !!focused && (focused.tagName === 'INPUT' || focused.tagName === 'TEXTAREA');\n    }\n\n    private keyDown(e: KeyboardEvent){\n\n        if (!this.ignoreKey() && this.controller.keyDown){\n            const result = this.controller.keyDown({key: e.key});\n\n            if (result && result.preventDefault === true){\n                e.preventDefault();\n            }\n        }\n    }\n\n    private keyUp(e: KeyboardEvent){\n        if (!this.ignoreKey() && this.controller.keyUp){\n            const result = this.controller.keyUp({key: e.key});\n\n            if (result && result.preventDefault === true){\n                e.preventDefault();\n            }\n        }\n    }\n\n    componentDidMount() {\n        this.resizer();\n\n        if (this.canvasRef.current){\n            const context = this.canvasRef.current.getContext(\"2d\");\n\n            if (context){\n\n                const draw = () => {\n                    this.controller.render(context, this.canvasSize);\n                    requestAnimationFrame(draw);\n                };\n\n                requestAnimationFrame(() => draw());\n\n            }else{\n                console.log(`No context`);\n            }\n        }else{\n            console.log(`No canvasRef`);\n        }\n\n    }\n\n    componentWillMount(): void {\n        window.addEventListener('resize', this.resizer);\n\n        document.addEventListener('keyup', this.keyUpCatcher);\n        document.addEventListener('keydown', this.keyDownCatcher);\n    }\n\n    componentWillUnmount(): void {\n\n        window.removeEventListener('resize', this.resizer);\n        document.removeEventListener('keyup', this.keyUpCatcher);\n        document.removeEventListener('keydown', this.keyDownCatcher);\n    }\n\n    componentDidUpdate(prevProps: Readonly<CanvasViewProps>, prevState: Readonly<{}>, snapshot?: any) {\n\n    }\n\n    render() {\n        return (\n            <div ref={this.containerRef} className={`canvas-view`}>\n                <canvas\n                    ref={this.canvasRef}\n                    onMouseDown={e => this.mouseDown(e)}\n                    onMouseMove={e => this.mouseMove(e)}\n                    onTouchStart={e => this.touchStart(e)}\n                    onTouchMove={e => this.touchMove(e)}\n                    onTouchEnd={e => this.touchEnd(e)}\n                ></canvas>\n            </div>\n        );\n    }\n\n    get controller(): CanvasViewController{\n        return this.props.controller;\n    }\n\n    get cursor(): string | null{\n        return this._cursor;\n    }\n\n    set cursor(value: string | null){\n\n        const changed = value !== this._cursor;\n\n        if(changed){\n\n            if(this.canvasRef.current) {\n                this.canvasRef.current.style.cursor = value || '';\n            }\n\n            this._cursor = value;\n        }\n    }\n}","import * as React from \"react\";\nimport {RefObject} from \"react\";\nimport {Callable} from \"../hui/helpers/hui\";\n\nexport interface PreviewPanelProps{\n    data: string;\n    onActivate?: Callable;\n    selected?: boolean;\n}\n\nexport class PreviewPanel extends React.Component<PreviewPanelProps>{\n\n    ref: RefObject<HTMLDivElement> = React.createRef();\n\n    private onActivate(){\n        if (this.props.onActivate){\n            this.props.onActivate();\n        }\n    }\n\n    render() {\n        return (\n            <div\n                ref={this.ref}\n                onClick={() => this.onActivate()}\n                className={`preview-panel ${this.props.selected ? 'selected' : ''}`}>\n                <img src={this.props.data} alt=\"\"/>\n            </div>\n        );\n    }\n\n}","import {Callable} from \"./hui\";\n\nexport class ClickDismiss{\n\n    static mouseup = new ClickDismiss('mouseup');\n\n    private static idReminder = 1;\n\n    private stack: {id: number, call: Callable}[] = [];\n\n    private preventNext = false;\n\n    private constructor(eventName: string){\n        window.addEventListener(eventName, e => {\n            if(this.preventNext) {\n                this.preventNext = false;\n                return;\n            }else{\n                if(this.stack.length > 0) {\n                    e.stopImmediatePropagation();\n                    this.popAndExecute();\n                }\n            }\n        });\n    }\n\n    isIdRegistered(id: number): boolean{\n        return this.stack.filter(m => m.id === id).length > 0;\n    }\n\n    register(call: Callable): number{\n\n        const id = ClickDismiss.idReminder++;\n\n        this.stack.push({id, call});\n\n        return id;\n\n    }\n\n    popAndExecute(){\n        const entry = this.stack.pop();\n\n        if(entry){\n            entry.call();\n            this.unregister(entry.id);\n        }\n    }\n\n    preventNextEvent(){\n        this.preventNext = true;\n    }\n\n    unregister(id: number){\n        this.stack = this.stack.filter(m => m.id != id);\n        this.preventNext = false;\n    }\n\n}","\nexport class InvalidColorFormatError extends Error{}\n\nexport class Color{\n\n    static hexParsable(hexColor: string): boolean{\n        return hexColor.match(/#?[0-9a-fA-F]{3}([0-9a-fA-F]{3})?/) !== null;\n    }\n\n    static fromHex(hexColor: string): Color{\n\n        if (!Color.hexParsable(hexColor)){\n            throw new InvalidColorFormatError(hexColor);\n        }\n\n        hexColor = hexColor.replace('#', '');\n\n        let toDecimal = function(hex: any){ return parseInt(hex, 16) };\n\n        let r = 0;\n        let g = 0;\n        let b = 0;\n        let a = 1;\n\n        // If three digits\n        if(hexColor.length == 3){\n            r = toDecimal(hexColor[0] + hexColor[0]);\n            g = toDecimal(hexColor[1] + hexColor[1]);\n            b = toDecimal(hexColor[2] + hexColor[2]);\n        }else{\n            r = toDecimal(hexColor[0] + hexColor[1]);\n            g = toDecimal(hexColor[2] + hexColor[3]);\n            b = toDecimal(hexColor[4] + hexColor[5]);\n\n            if(hexColor.length == 8) {\n                a = toDecimal(hexColor[6] + hexColor[7]);\n            }\n        }\n\n        return new Color(r, g, b, a);\n\n    }\n\n    /**\n     * HSV to RGB color conversion\n     *\n     * H runs from 0 to 360 degrees\n     * S and V run from 0 to 1\n     *\n     * Ported from the excellent java algorithm by Eugene Vishnevsky at:\n     * http://www.cs.rit.edu/~ncs/color/t_convert.html\n     */\n    static fromHsv(h: number, s: number, v: number): Color{\n        let r, g, b;\n        let i;\n        let f, p, q, t;\n\n        // Make sure our arguments stay in-range\n        h = Math.max(0, Math.min(360, h));\n        s = Math.max(0, Math.min(100, s));\n        v = Math.max(0, Math.min(100, v));\n\n        if(s == 0) {\n            // Achromatic (grey)\n            r = g = b = v;\n            return new Color(Math.round(r * 255), Math.round(g * 255), Math.round(b * 255));\n        }\n\n        h /= 60; // sector 0 to 5\n        i = Math.floor(h);\n        f = h - i; // factorial part of h\n        p = v * (1 - s);\n        q = v * (1 - s * f);\n        t = v * (1 - s * (1 - f));\n\n        switch(i) {\n            case 0: r = v; g = t; b = p; break;\n            case 1: r = q; g = v; b = p; break;\n            case 2: r = p; g = v; b = t; break;\n            case 3: r = p; g = q; b = v; break;\n            case 4: r = t; g = p; b = v; break;\n            default: r = v; g = p; b = q;\n        }\n\n        return new Color(Math.round(r * 255), Math.round(g * 255), Math.round(b * 255));\n    }\n\n    static get transparent(): Color{\n        return new Color(0, 0, 0, 0);\n    }\n\n    constructor(\n        readonly r: number,     //  0 - 255\n        readonly g: number,     //  0 - 255\n        readonly b: number,     //  0 - 255\n        readonly a: number = 1, //  0 - 1\n    ) {}\n\n    get cssRgb(): string{\n        return `rgb(${this.r}, ${this.g}, ${this.b})`;\n    }\n\n    get cssRgba(): string{\n        return `rgba(${this.r}, ${this.g}, ${this.b}, ${this.a})`;\n    }\n\n    get hexRgb(): string{\n\n        const hex = (n: number) => {\n            const result = n.toString(16);\n            return result.length == 1 ? `0${result}` : result;\n        }\n\n        return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}`\n    }\n\n    get hexRgba(): string{\n\n        const hex = (n: number) => {\n            const result = n.toString(16);\n            return result.length == 1 ? `0${result}` : result;\n        }\n\n        return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex(Math.round(this.a * 255))}`\n    }\n\n    get hsv(): [number, number, number]{\n        let rr, gg, bb;\n        let r = this.r / 255;\n        let g = this.g / 255;\n        let b = this.b / 255;\n        let h = 0;\n        let s = 0;\n        let v = Math.max(r, g, b);\n        let diff = v - Math.min(r, g, b);\n        let diff_c = (c: number) => { return (v - c) / 6 / diff + 1 / 2 };\n\n        if(diff == 0) {\n            h = s = 0;\n        }else {\n            s = diff / v;\n            rr = diff_c(r);\n            gg = diff_c(g);\n            bb = diff_c(b);\n\n            if(r === v) {\n                h = bb - gg;\n            }else if(g === v) {\n                h = (1 / 3) + rr - bb;\n            }else if(b === v) {\n                h = (2 / 3) + gg - rr;\n            }\n        }\n\n        if(h < 0) {\n            h += 1;\n        }else if(h > 1) {\n            h -= 1;\n        }\n\n        return [\n            Math.round(h * 360),\n            Math.round(s),\n            Math.round(v)\n        ];\n    }\n\n    get isTransparent(): boolean{\n        return (this.r === 0 &&\n            this.g ===  0 &&\n            this.b ===  0 &&\n            this.a === 0);\n    }\n\n    get tupleInt8(): [number, number, number, number]{\n        return [this.r, this.g, this.b, Math.round(this.a * 255)];\n    }\n\n}","/**\n * Keeps a stack for globally reacting to keys, like Escape and Enter.\n */\nimport {Callable} from \"./hui\";\n\nexport class\nFocusStackHandler{\n\n    private static idReminder = 1;\n\n    static dismiss = new FocusStackHandler('Escape');\n\n    static commit = new FocusStackHandler('Enter');\n\n    private stack: {id: number, call: Callable}[] = [];\n\n    private constructor(key: string){\n\n        window.addEventListener('keydown', e => {\n            if(e.key === key) {\n                if(this.stack.length > 0) {\n                    e.stopImmediatePropagation();\n                    this.popAndExecute();\n                }\n            }\n        });\n    }\n\n    isIdRegistered(id: number): boolean{\n        return this.stack.filter(m => m.id === id).length > 0;\n    }\n\n    register(call: Callable): number{\n\n        const id = FocusStackHandler.idReminder++;\n\n        this.stack.push({id, call});\n\n        return id;\n\n    }\n\n    popAndExecute(){\n        const entry = this.stack.pop();\n\n        if(entry){\n            entry.call();\n            this.unregister(entry.id);\n        }\n    }\n\n    unregister(id: number){\n        this.stack = this.stack.filter(m => m.id != id);\n    }\n\n}","export type KeyCaptureEvent = (e: KeyboardEvent) => void;\n\nexport class KeyCaptureStackHandler{\n    private static idReminder = 1;\n\n    static instance = new KeyCaptureStackHandler();\n\n    private stack: {id: number, call: KeyCaptureEvent}[] = [];\n\n    private constructor(){\n        window.addEventListener('keydown', e => {\n            if(this.stack.length > 0) {\n                this.execute(e);\n            }\n        }, true);\n    }\n\n    isIdRegistered(id: number): boolean{\n        return this.stack.filter(m => m.id === id).length > 0;\n    }\n\n    register(call: KeyCaptureEvent): number{\n\n        const id = KeyCaptureStackHandler.idReminder++;\n\n        this.stack.push({id, call});\n\n        return id;\n\n    }\n\n    private execute(e: KeyboardEvent){\n        if(this.stack.length > 0) {\n            const entry = this.stack[this.stack.length - 1];\n            entry.call(e);\n        }\n    }\n\n    unregister(id: number){\n        this.stack = this.stack.filter(m => m.id != id);\n    }\n}","\nexport interface Point {\n    x: number;\n    y: number;\n}\n\nexport interface Rect{\n    left: number,\n    top: number,\n    width: number,\n    height: number,\n}\n\nexport interface Size {\n    width: number;\n    height: number;\n}\n\nexport type BasicCardinalPoint = 'n' | 'e' | 's' | 'w';\nexport type CardinalPoint = BasicCardinalPoint | 'ne' | 'se' | 'sw'| 'nw';\n\nexport function makePt(x: number, y: number): Point {\n    return {x, y};\n}\n\nexport function makeSz(width: number, height: number): Size{\n    return {width, height};\n}\n\nexport function slope(a: Point, b: Point): number{\n    return (b.y - a.y) / (b.x - a.x);\n}\n\nexport function midPoint(a: Point, b: Point): Point {\n    return {x: (a.x + b.x) / 2, y: (a.y + b.y) / 2};\n}\n\nexport function distance(a: Point, b: Point): number{\n    return Math.sqrt(Math.pow(b.x - a.x, 2) + Math.pow(b.y - a.y, 2));\n}\n\nexport function scaleToContain(container: Size, scalable: Size): Size{\n\n    const wOriented = makeSz(container.width, container.width * scalable.height / scalable.width);\n    const hOriented = makeSz(container.height * scalable.width / scalable.height, container.height);\n\n    if (wOriented.width <= container.width && wOriented.height <= container.height){\n        return wOriented;\n    }\n\n    return hOriented;\n}\n\nexport class Rectangle{\n\n    static get empty(): Rectangle{\n        return new Rectangle(0, 0, 0, 0);\n    }\n\n    static fromRect(r: Rect): Rectangle{\n        return new Rectangle(r.left, r.top, r.width, r.height);\n    }\n\n    static fromDOMRect(r: DOMRect): Rectangle{\n        return new Rectangle(r.left, r.top, r.width, r.height);\n    }\n\n    static fromLTRB(left: number, top: number, right: number, bottom: number): Rectangle{\n        return new Rectangle(left, top, right - left, bottom - top);\n    }\n\n    static fromPoint(p: Point): Rectangle{\n        return new Rectangle(p.x, p.y, 0, 0);\n    }\n\n    static fromSize(s: Size): Rectangle{\n        return new Rectangle(0, 0, s.width, s.height);\n    }\n\n    static unionOf(...rects: Rectangle[]): Rectangle | null{\n\n        if(rects.length == 0) {\n            return null;\n        }\n\n        let current = rects[0];\n\n        for(let i = 1; i < rects.length; i++){\n            current = current.union(rects[i]);\n        }\n\n        return current;\n    }\n\n    constructor(readonly left: number, readonly top:number, readonly width: number, readonly height: number){}\n\n    centerAt(point: Point): Rectangle{\n        return this.withLocation(makePt(\n            point.x - this.width / 2,\n            point.y - this.height / 2\n        ));\n    }\n\n    clone(): Rectangle{\n        return new Rectangle(this.left, this.top, this.width, this.height);\n    }\n\n    contains(p: Point): boolean{\n        return p.x >= this.left && p.x < this.right && p.y >= this.top && p.y < this.bottom;\n    }\n\n    deflate(horizontal: number, vertical: number): Rectangle{\n        return Rectangle.fromLTRB(this.left + horizontal, this.top + vertical, this.right - horizontal, this.bottom - vertical);\n    }\n\n    equals(r: Rectangle): boolean{\n        return r.left === this.left &&\n            r.top === this.top &&\n            r.width === this.width &&\n            r.height === this.height;\n    }\n\n    getCardinalPoint(c: CardinalPoint): Point{\n        switch (c) {\n            case 'n': return this.north;\n            case 'ne': return this.northEast;\n            case 'e': return this.east;\n            case 'se': return this.southEast;\n            case 's': return this.south;\n            case 'sw': return this.southWest;\n            case 'w': return this.west;\n            case 'nw': return this.northWest;\n        }\n    }\n\n    inflate(horizontal: number, vertical: number): Rectangle{\n        return Rectangle.fromLTRB(this.left - horizontal, this.top - vertical, this.right + horizontal, this.bottom + vertical);\n    }\n\n    intersects(rectangle: Rectangle): boolean{\n        let thisX = this.left;\n        let thisY = this.top;\n        let thisW = this.width;\n        let thisH = this.height;\n        let rectX = rectangle.left;\n        let rectY = rectangle.top;\n        let rectW = rectangle.width;\n        let rectH = rectangle.height;\n        return (rectX < thisX + thisW) && (thisX < (rectX + rectW)) && (rectY < thisY + thisH) && (thisY < rectY + rectH);\n    }\n\n    round(): Rectangle{\n        return new Rectangle(\n            Math.round(this.left),\n            Math.round(this.top),\n            Math.round(this.width),\n            Math.round(this.height),\n        );\n    }\n\n    toString(){\n        return `(Rect: ${this.left}, ${this.top}, ${this.width}, ${this.height})`;\n    }\n\n    union(r: Rectangle): Rectangle{\n        const x = [this.left, this.right, r.left, r.right];\n        const y = [this.top, this.bottom, r.top, r.bottom];\n        return Rectangle.fromLTRB(\n            Math.min(...x), Math.min(...y),\n            Math.max(...x), Math.max(...y)\n        );\n    }\n\n    withBottom(bottom: number){\n        return new Rectangle(this.left, bottom - this.height, this.width, this.height);\n    }\n\n    withHeight(height: number){\n        return new Rectangle(this.left, this.top, this.width, height);\n    }\n\n    withLeft(left: number){\n        return new Rectangle(left, this.top, this.width, this.height);\n    }\n\n    withLocation(location: Point): Rectangle{\n        return new Rectangle(location.x, location.y, this.width, this.height);\n    }\n\n    withRight(right: number){\n        return new Rectangle(right - this.width, this.top, this.width, this.height);\n    }\n\n    withSize(size: Size): Rectangle{\n        return new Rectangle(this.left, this.top, size.width, size.height);\n    }\n\n    withTop(top: number){\n        return new Rectangle(this.left, top, this.width, this.height);\n    }\n\n    withWidth(width: number){\n        return new Rectangle(this.left, this.top, width, this.height);\n    }\n\n    get center(): Point{\n        return {\n            x: this.left + this.width / 2,\n            y: this.top + this.height / 2\n        };\n    }\n\n    get isEmpty(): boolean{\n        return this.width == 0 && this.height == 0 && this.left == 0 && this.top == 0;\n    }\n\n    get right(): number{\n        return this.left + this.width;\n    }\n\n    get bottom(): number{\n        return this.top + this.height;\n    }\n\n    get location(): Point{\n        return makePt(this.left, this.top);\n    }\n\n    get tuple(): [number, number, number, number]{\n        return [this.left, this.top, this.width, this.height];\n    }\n\n    get northEast(): Point{\n        return {x: this.right, y: this.top};\n    }\n\n    get southEast(): Point{\n        return {x: this.right, y: this.bottom};\n    }\n\n    get southWest(): Point{\n        return {x: this.left, y: this.bottom};\n    }\n\n    get northWest(): Point{\n        return {x: this.left, y: this.top};\n    }\n\n    get east(): Point{\n        return makePt(this.right, this.center.y);\n    }\n\n    get north(): Point{\n        return makePt(this.center.x, this.top);\n    }\n\n    get south(): Point{\n        return makePt(this.center.x, this.bottom);\n    }\n\n    get west(): Point{\n        return makePt(this.left, this.center.y);\n    }\n\n    get size(): Size{\n        return {width: this.width, height: this.height};\n    }\n}","\nexport class GraphicsMemoryError extends Error{}","import * as React from \"react\";\nimport {ClickableProps} from \"./Clickable\";\nimport {Label} from \"./Label\";\nimport {Icon} from \"./Icon\";\nimport {KeyboardEvent, RefObject} from \"react\";\nimport {MenuOverlay} from \"../overlays/MenuOverlay\";\nimport {Callable} from \"../helpers/hui\";\nimport {FocusStackHandler} from \"../helpers/FocusStackHandler\";\nimport {ClickDismiss} from \"../helpers/ClickDismiss\";\nimport {Rectangle} from \"../helpers/Rectangle\";\n\nexport interface ButtonProps extends ClickableProps{\n    children?: React.ReactNode;\n    onClick?: Callable;\n    split?: boolean;\n    face?: \"hover\" | \"always\" | \"never\";\n    classTag?: string;\n    disabled?: boolean;\n    selected?: boolean;\n}\n\nexport interface ButtonState {\n    dropDownVisible?: boolean;\n}\n\nexport class Button extends React.Component<ButtonProps, ButtonState>{\n\n    buttonRef: RefObject<HTMLDivElement>;\n\n    private escapeKeyDismissId = 0;\n    private clickDismissId = 0;\n\n    constructor(props: ButtonProps){\n        super(props);\n        this.buttonRef = React.createRef();\n        this.state = {};\n        this.activate = this.activate.bind(this);\n        this.showDropDown = this.showDropDown.bind(this);\n        this.hideDropDown = this.hideDropDown.bind(this);\n        this.keyDownHide = this.keyDownHide.bind(this);\n        this.keyDownShow = this.keyDownShow.bind(this);\n        this.keyDownActivate = this.keyDownActivate.bind(this);\n    }\n\n    activate(){\n        if(this.props.disabled !== true && this.props.onClick) {\n            this.props.onClick();\n        }\n    }\n\n    keyPass(e: KeyboardEvent<HTMLDivElement>, call: Callable){\n        if(e.key === 'Enter' || e.key === ' ') {\n            if(!this.props.disabled) {\n                e.stopPropagation();\n                e.preventDefault();\n                call();\n            }\n        }\n    }\n\n    keyDownHide(e: KeyboardEvent<HTMLDivElement>){\n        this.keyPass(e, () => this.hideDropDown());\n    }\n\n    keyDownShow(e: KeyboardEvent<HTMLDivElement>){\n        if(this.props.disabled) {\n            return;\n        }\n        this.keyPass(e, () => this.showDropDown());\n    }\n\n    keyDownActivate(e: KeyboardEvent<HTMLDivElement>){\n        this.keyPass(e, () => this.activate());\n    }\n\n    hideDropDown(){\n        this.setState({dropDownVisible: false});\n\n        // Unregister for ESC key\n        FocusStackHandler.dismiss.unregister(this.escapeKeyDismissId);\n\n        // Unregister from body click\n        ClickDismiss.mouseup.unregister(this.clickDismissId);\n    }\n\n    showDropDown(){\n        this.setState({dropDownVisible: true});\n\n        // Register for hiding when ESC key is pressed\n        this.escapeKeyDismissId = FocusStackHandler.dismiss.register(() => { this.hideDropDown(); });\n\n        // Register for hiding when body is clicked\n        this.clickDismissId = ClickDismiss.mouseup.register(() => this.hideDropDown());\n    }\n\n    render(){\n        const rect = Rectangle.fromDOMRect(this.buttonRef.current?.getBoundingClientRect() || new DOMRect());\n        const chevron = () => <Icon name={\"chevron-down\"} size={8}/>;\n        const label = () => <Label {...this.props} />;\n        const menu = () => (\n            <MenuOverlay\n                top={rect.top + rect.height}\n                left={rect.left}\n                refRect={rect}\n                onDismissSignal={this.hideDropDown}>\n                {this.props.children}\n            </MenuOverlay>\n        );\n\n        const tags = [\n                `face-${this.props.face || 'hover'}`,\n                 this.props.classTag,\n                 this.props.disabled ? 'disabled' : null,\n                 this.props.selected ? 'selected' : null,\n            ]\n            .filter(a => !!a)\n            .join(` `);\n\n        const tabProp = this.props.disabled ? {} : {tabIndex: 0};\n\n        if(this.props.children) {\n            if(this.props.split) {\n                if(this.state.dropDownVisible) {\n                    return (\n                        <div className={`ui-button-wrap split `}>\n                            <div {...tabProp}\n                                 ref={this.buttonRef}\n                                 className={`ui-clickable ui-button is-open ${tags}`}\n                                 onClick={this.activate}>\n                                {label()}\n                            </div>\n                            <div {...tabProp}\n                                 className={`ui-clickable ui-button split-part`}\n                                 onClick={this.showDropDown}\n                                 onKeyDown={this.keyDownShow}>\n                                {chevron()}\n                                {menu()}\n                            </div>\n                        </div>\n                    )\n                }else{\n                    return (\n                        <div className={`ui-button-wrap split ${tags}`}>\n                            <div {...tabProp}\n                                 ref={this.buttonRef}\n                                 className={\"ui-clickable ui-button\"}\n                                 onKeyDown={this.keyDownActivate}\n                                 onClick={this.activate}>\n                                {label()}\n                            </div>\n                            <div {...tabProp}\n                                 className={`ui-clickable ui-button split-part`}\n                                 onClick={this.showDropDown}\n                                 onKeyDown={this.keyDownShow}>\n                                {chevron()}\n                            </div>\n                        </div>\n                    )\n                }\n\n            }else if(this.state.dropDownVisible) {\n                return (\n                    <div className={`ui-button-wrap`}>\n                        <div {...tabProp}\n                             ref={this.buttonRef}\n                             className={`ui-clickable ui-button is-open ${tags}`}\n                             onKeyDown={this.keyDownHide}\n                             onClick={this.showDropDown}>\n                            {label()}\n                            {chevron()}\n                        </div>\n                        {menu()}\n                    </div>\n                )\n            }else{\n                return (\n                    <div className={`ui-button-wrap`}>\n                        <div {...tabProp}\n                             ref={this.buttonRef}\n                             className={`ui-clickable ui-button ${tags}`}\n                             onClick={this.showDropDown}\n                             onKeyDown={this.keyDownShow}>\n                            {label()}\n                            {chevron()}\n                        </div>\n                    </div>\n                )\n            }\n        }else{\n            return (\n                <div {...tabProp}\n                     ref={this.buttonRef}\n                     className={`ui-clickable ui-button ${tags}`}\n                     onClick={this.activate}\n                     onKeyDown={this.keyDownActivate}>\n                    {label()}\n                </div>\n            )\n        }\n    }\n}","import * as React from \"react\";\nimport {Color} from \"../helpers/Color\";\nimport {RefObject} from \"react\";\nimport {GraphicsMemoryError} from \"../helpers/errors\";\nimport {Range} from \"./Range\";\nimport {makePt, makeSz, Size} from \"../helpers/Rectangle\";\n\nexport interface ColorPickerProps{\n    colorPicked: (color: Color) => any;\n}\n\nexport interface ColorPickerState{\n    currentColor: Color;\n    selectedHue: number;\n}\n\ntype ColorPickerFocus = 'hex' | 'r' | 'g' | 'b' | 'a';\nconst ColorPickerFields: ColorPickerFocus[] = ['hex', 'r', 'g', 'b', 'a'];\n\nfunction dataUrlFrom(data: Uint8ClampedArray, width: number): string{\n    const imageData = new ImageData(data, width);\n    const canvas: HTMLCanvasElement = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = data.length / 4 / width;\n\n    const cx = canvas.getContext('2d');\n\n    if(!cx){\n        throw new GraphicsMemoryError();\n    }\n\n    cx.putImageData(imageData, 0,0);\n\n    return canvas.toDataURL();\n}\n\nfunction createHuePattern(): string{\n    const convert = (foo: number, hue: number) => Color.fromHsv(hue, 1, 1).tupleInt8;\n    const array360 = new Array(360).fill(0);\n    const arrayColors = array360.map(convert);\n    const flatArrayColors: number[] = [].concat(...arrayColors as any);\n    const data = new Uint8ClampedArray(flatArrayColors);\n    return dataUrlFrom(data, 360);\n}\n\nfunction createSaturationPattern(hue = 1, length = 10): string{\n\n    const arr = new Uint8ClampedArray(length * length * 4);\n    let z = 0\n\n    for(let j = length; j >= 0; j--){\n        for(let i = 0; i < length; i++){\n            const hsv = Color.fromHsv(hue, i/length, j/length);\n            let [r, g, b, a] = hsv.tupleInt8;\n            arr[z++] = r;\n            arr[z++] = g;\n            arr[z++] = b;\n            arr[z++] = a;\n        }\n    }\n\n    return dataUrlFrom(arr, length);\n}\n\nexport class ColorPicker extends React.Component<ColorPickerProps, ColorPickerState>{\n\n    static hueBar = createHuePattern();\n\n    private focus: ColorPickerFocus | null = null;\n    private txtHex: RefObject<HTMLInputElement> = React.createRef();\n    private txtR: RefObject<HTMLInputElement> = React.createRef();\n    private txtG: RefObject<HTMLInputElement> = React.createRef();\n    private txtB: RefObject<HTMLInputElement> = React.createRef();\n    private txtA: RefObject<HTMLInputElement> = React.createRef();\n\n    constructor(props: ColorPickerProps) {\n        super(props);\n\n        this.state = {\n            currentColor: Color.transparent,\n            selectedHue: -1,\n        }\n\n    }\n\n    private getInput(type: ColorPickerFocus): HTMLInputElement{\n\n        let ref: RefObject<HTMLInputElement>;\n\n        switch (type){\n            case \"a\": ref = this.txtA; break;\n            case \"r\": ref = this.txtR; break;\n            case \"g\": ref = this.txtG; break;\n            case \"b\": ref = this.txtB; break;\n            case \"hex\": ref = this.txtHex; break;\n        }\n\n        if (ref.current){\n            return ref.current;\n        }\n\n        throw new Error(`No input element for: ${type}`);\n    }\n\n    private getInputValueFor(type: ColorPickerFocus): string{\n\n        const color = this.state.currentColor;\n\n        switch (type){\n            case \"a\": return color.a.toString();\n            case \"r\": return color.r.toString();\n            case \"g\": return color.g.toString();\n            case \"b\": return color.b.toString();\n            case \"hex\": return color.a !== 1 ? color.hexRgba : color.hexRgb;\n        }\n\n    }\n\n    private updateColor(color: Color, selectedHue?: number){\n\n        this.setState({currentColor: color, selectedHue: typeof selectedHue === \"number\" ? selectedHue : -1});\n\n        if (this.props.colorPicked){\n            this.props.colorPicked(color);\n        }\n    }\n\n    private updateHue(hue: number){\n        const color = this.state.currentColor;\n        const hsv = color.hsv;\n        this.updateColor(Color.fromHsv(hue, hsv[1], hsv[2]), hue);\n    }\n\n    private updateAlpha(alpha: number){\n\n    }\n\n    private updateSat(dim: Size){\n        const hue = this.state.selectedHue;\n        const sat = dim.width / 100;\n        const light = 1 - dim.height / 100;\n        this.updateColor(Color.fromHsv(hue >= 0 ? hue : 0, sat, light), hue);\n    }\n\n    private handleChange(where: ColorPickerFocus){\n        const txt = this.getInput(where);\n        if (where == 'hex'){\n            const value = txt.value;\n            if (Color.hexParsable(value)){\n                this.updateColor(Color.fromHex(value));\n            }\n        }else{\n            const a = parseInt(this.getInput(\"a\").value) || 0;\n            const b = parseInt(this.getInput(\"b\").value) || 0;\n            const g = parseInt(this.getInput(\"g\").value) || 0;\n            const r = parseInt(this.getInput(\"r\").value) || 0;\n            const color = new Color(r, g, b, a);\n            this.updateColor(color);\n        }\n    }\n\n    componentDidMount() {\n        ColorPickerFields.forEach(type => {\n            const txt = this.getInput(type);\n\n            txt.addEventListener('input', () => this.handleChange(type));\n            txt.addEventListener('focus', () => {\n                this.focus = type;\n            });\n            txt.addEventListener('blur', () => {\n                this.focus = null;\n            });\n        });\n    }\n\n    syncInputValues(){\n        for(const type of ColorPickerFields){\n            if (this.focus !== type){\n                this.getInput(type).value = this.getInputValueFor(type);\n            }\n        }\n    }\n\n    render() {\n\n        if (this.txtHex.current){\n            this.syncInputValues(); // Dont update if not rendered yet\n        }\n\n        const color = this.state.currentColor;\n        const hsv = color.hsv;\n        const hue = this.state.selectedHue >= 0 ? this.state.selectedHue : hsv[0];\n        const alpha = color.a * 100;\n\n        const satImg = createSaturationPattern(hue, 10);\n        const hueHandleStyle = {background: Color.fromHsv(hue, 1, 1).hexRgb}\n        const hueContainerStyle = {backgroundImage: `url(${ColorPicker.hueBar})`};\n        const satContainerStyle = {backgroundImage: `url(${satImg})`}\n\n        return (\n            <div className=\"ui-color-picker\">\n                <div className=\"layer swatch\"><div className=\"swatch\" style={{background: color.cssRgba}}/></div>\n                <div className=\"layer slider-2d\">\n                    <Range\n                        min={makeSz(0,0)}\n                        max={makeSz(100, 100)}\n                        value={makeSz(0,0)}\n                        direction={'2d'}\n                        containerStyle={satContainerStyle}\n                        onChange={sat => this.updateSat(sat as Size)}\n                    />\n                </div>\n                <div className=\"layer slider-1d\">\n                    <Range\n                        min={0}\n                        max={359}\n                        value={hue}\n                        handleStyle={hueHandleStyle}\n                        containerStyle={hueContainerStyle}\n                        onChange={hue => this.updateHue(hue as number)}\n                    />\n                </div>\n                <div className=\"layer slider-alpha\">\n                    <Range\n                        min={0}\n                        max={100}\n                        value={alpha}\n                        onChange={a => this.updateAlpha(a as number)}\n                    />\n                </div>\n                <div className=\"layer inputs\">\n                    <div className=\"item\">\n                        <input type=\"text\" ref={this.txtHex}/>\n                        <div className=\"label\">Hex</div>\n                    </div>\n                    <div className=\"item\">\n                        <input type=\"text\" ref={this.txtR}/>\n                        <div className=\"label\">R</div>\n                    </div>\n                    <div className=\"item\">\n                        <input type=\"text\" ref={this.txtG}/>\n                        <div className=\"label\">G</div>\n                    </div>\n                    <div className=\"item\">\n                        <input type=\"text\" ref={this.txtB}/>\n                        <div className=\"label\">B</div>\n                    </div>\n                    <div className=\"item\">\n                        <input type=\"text\" ref={this.txtA}/>\n                        <div className=\"label\">A</div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n}","import * as React from \"react\";\n\nexport type IconSize = 8 | 16 | 32;\nexport type IconName = \"empty\" | \"cross\" | \"floppy\" | \"file\" | \"folder\" | \"chevron-up\" | \"chevron-down\" | \"chevron-left\" | \"chevron-right\";\n\nexport interface IconProps{\n    classNames?: string;\n    name: IconName;\n    size?: IconSize;\n}\n\nexport const Icon = (props: IconProps) => {\n    return <div className={`ui-icon size-${props.size || 16} icon-${props.name} ${props.classNames || ''}`} />;\n};","import * as React from \"react\";\nimport {Icon, IconName, IconSize} from \"./Icon\";\n\nexport interface LabelProps{\n    text?: string;\n    icon?: IconName;\n    iconSize?: IconSize;\n    description?: string;\n}\n\nexport const Label = (props: LabelProps) => {\n\n    if(props.icon && !props.text) {\n        return <div className={\"ui-label\"}>\n            <Icon name={props.icon} size={props.iconSize}/>\n        </div>\n    }else if(!props.icon && !props.description) {\n        return <div className=\"ui-label\">{props.text}</div>;\n\n    }else if(!props.icon && props.description) {\n        return <div className=\"ui-label\">\n            <div className=\"text\">{props.text}</div>\n            <div className=\"desc\">{props.description}</div>\n        </div>;\n\n    }else if(props.icon){\n        if(props.description) {\n            return <div className=\"ui-label with-icon\">\n                <Icon name={props.icon} size={props.iconSize} />\n                <div className=\"text-side\">\n                    <div className=\"text\">{props.text}</div>\n                    <div className=\"desc\">{props.description}</div>\n                </div>\n            </div>\n        }else{\n            return <div className=\"ui-label with-icon\">\n                <Icon name={props.icon} size={props.iconSize} />\n                <div className=\"text\">{props.text}</div>\n            </div>\n        }\n    }else{\n        throw \"Undesired configuration\";\n    }\n};","import * as React from \"react\";\nimport {Label, LabelProps} from \"./Label\";\nimport {Icon} from \"./Icon\";\nimport {MenuOverlay} from \"../overlays/MenuOverlay\";\nimport {RefObject} from \"react\";\nimport {Callable} from \"../helpers/hui\";\nimport {ClickDismiss} from \"../helpers/ClickDismiss\";\nimport {Rectangle} from \"../helpers/Rectangle\";\n\nexport interface MenuItemProps  extends LabelProps{\n    children?: React.ReactNode;\n    isOpen?: boolean;\n    isSelected?: boolean;\n    isActivated?: boolean;\n    onOpen?: Callable;\n    onClose?: Callable;\n    onActivate?: Callable;\n    onDismissSignal?: Callable;\n    onDismissSingleSignal?: Callable;\n    onSelectSignal?: Callable;\n    parent?: MenuOverlay;\n}\n\nexport interface MenuItemState {\n}\n\nexport class MenuItem extends React.Component<MenuItemProps, MenuItemState>{\n\n    ref: RefObject<HTMLDivElement>;\n\n    constructor(props: MenuItemProps){\n        super(props);\n        this.ref = React.createRef();\n        this.showOverlay = this.showOverlay.bind(this);\n        this.hideOverlay = this.hideOverlay.bind(this);\n        this.mouseActivate = this.mouseActivate.bind(this);\n        this.sendDismissSignal = this.sendDismissSignal.bind(this);\n        this.sendDismissSingleSignal = this.sendDismissSingleSignal.bind(this);\n        this.sendSelectSignal = this.sendSelectSignal.bind(this);\n    }\n\n    mouseActivate(e: React.MouseEvent<HTMLDivElement, MouseEvent>){\n        e.stopPropagation();\n\n        this.activate();\n    }\n\n    activate(){\n\n        if(this.props.onActivate) {\n            this.props.onActivate();\n        }\n\n        this.sendDismissSignal();\n\n    }\n\n    hideOverlay(e: React.MouseEvent<HTMLDivElement, MouseEvent>){\n\n        ClickDismiss.mouseup.preventNextEvent();\n        e.stopPropagation();\n\n        if(this.props.onClose) {\n            this.props.onClose();\n        }\n    }\n\n    showOverlay(e: React.MouseEvent<HTMLDivElement, MouseEvent>){\n\n        ClickDismiss.mouseup.preventNextEvent();\n\n        e.stopPropagation();\n\n        if(this.props.onOpen && this.ref && this.ref.current) {\n            this.props.onOpen();\n        }\n    }\n\n\n    render(){\n\n        const selectedClass = this.props.isSelected ? 'is-selected' : '';\n        const propsWithIcon = Object.assign({icon: \"empty\"}, this.props);\n\n        if(this.props.isActivated === true && React.Children.count(this.props.children) === 0) {\n            setTimeout(() => this.activate());\n        }\n\n        if(this.props.children) {\n\n            const rect = Rectangle.fromDOMRect(this.ref.current?.getBoundingClientRect() || new DOMRect());\n\n            if(this.props.isOpen) {\n                return (\n                    <div ref={this.ref} className={`ui-menuitem is-selected is-open`} onMouseDown={this.hideOverlay}>\n                        <Label {...propsWithIcon} />\n                        <Icon name={`chevron-right`} size={8} />\n                        <MenuOverlay\n                            left={rect.right} top={rect.top} refRect={rect} parentMenuItem={this}\n                            onDismissSingleSignal={this.sendDismissSingleSignal}\n                            onDismissSignal={this.sendDismissSignal}>\n                            {this.props.children}\n                        </MenuOverlay>\n                    </div>\n                )\n            }else{\n                return (\n                    <div ref={this.ref}\n                         className={`ui-menuitem ${selectedClass}`}\n                         onMouseEnter={this.sendSelectSignal}\n                         onMouseDown={this.showOverlay}>\n                        <Label {...propsWithIcon} />\n                        <Icon name={`chevron-right`} size={8} />\n                    </div>\n                )\n            }\n        }else{\n            return (\n                <div ref={this.ref}\n                     className={`ui-menuitem ${selectedClass}`}\n                     onMouseEnter={this.sendSelectSignal}\n                     onMouseDown={this.mouseActivate}>\n                    <Label {...propsWithIcon} />\n                </div>\n            )\n        }\n    }\n\n    sendDismissSignal(){\n        if(this.props.onDismissSignal) {\n            this.props.onDismissSignal();\n        }\n    }\n\n    sendDismissSingleSignal(){\n        if(this.props.onDismissSingleSignal) {\n            this.props.onDismissSingleSignal();\n        }\n    }\n\n    sendSelectSignal(){\n        if(this.props.onSelectSignal) {\n            this.props.onSelectSignal();\n        }\n    }\n}","\nimport * as React from \"react\";\nimport {makePt, makeSz, Point, Rectangle, Size} from \"../helpers/Rectangle\";\nimport {CSSProperties, RefObject} from \"react\";\n\nexport interface SliderProps{\n    min: number | Size;\n    max: number | Size;\n    value?: number | Size;\n    onChange?: (value: number | Size) => void;\n    containerStyle?: CSSProperties;\n    handleStyle?: CSSProperties;\n    direction?: 'horizontal' | 'vertical' | '2d';\n}\n\nexport interface SliderState{\n    value: number | Size;\n}\n\ninterface GestureData{\n    clientX: number;\n    clientY: number;\n    target: EventTarget | null;\n}\n\nexport class Range extends React.Component<SliderProps, SliderState>{\n\n    private containerRef: RefObject<HTMLDivElement> = React.createRef();\n    private handleRef: RefObject<HTMLDivElement> = React.createRef();\n    private dragging = false;\n    private handleOffset: Point = makePt(0, 0);\n\n    private mouseMoveHandler = (e: MouseEvent) => this.mouseMove(e);\n    private mouseUpHandler = (e: MouseEvent) => this.mouseUp(e);\n    private touchMoveHandler = (e: TouchEvent) => this.touchMove(e);\n    private touchEndHandler = (e: TouchEvent) => this.touchEnd(e);\n\n    constructor(props: SliderProps) {\n        super(props);\n\n        this.state = {\n            value: props.value || props.min,\n        };\n    }\n\n    private valueFromRects(): number | Size{\n\n        const {container, handle} = this.boundingRects();\n        const max = this.props.max;\n        const min = this.props.min;\n\n        if(this.props.direction === '2d') {\n\n            if(typeof max == \"number\" || typeof min == \"number\"){\n                throw new Error(`min and max must be Size`)\n            }\n\n            const maxSpace = makeSz(container.width - handle.width, container.height - handle.height);\n            const curSpace = makeSz(handle.left - container.left, handle.top - container.top);\n            return makeSz(\n                Math.round(curSpace.width * (max.width - min.width) / maxSpace.width + min.width),\n                Math.round(curSpace.height * (max.height - min.height) / maxSpace.height + min.height)\n            );\n\n        }else{\n\n            if(typeof max !== \"number\" || typeof min !== \"number\"){\n                throw new Error(`min and max must be number`);\n            }\n\n            if (this.props.direction !== 'vertical'){\n                const maxSpace = container.width - handle.width;\n                const curSpace = handle.left - container.left;\n                return Math.round(curSpace * (max - min) / maxSpace + min);\n\n            }else{\n                const maxSpace = container.height - handle.height;\n                const curSpace = handle.top - container.top;\n                return Math.round(curSpace * (max - min) / maxSpace + min);\n            }\n        }\n    }\n\n    private handleMouseDown(e: React.MouseEvent<HTMLDivElement, MouseEvent>){\n        this.pointingGestureStart(e);\n        e.preventDefault();\n\n        window.addEventListener('mousemove', this.mouseMoveHandler);\n        window.addEventListener('mouseup', this.mouseUpHandler);\n    }\n\n    private handleTouchStart(e: React.TouchEvent<HTMLDivElement>){\n\n        if (e.touches.length > 0){\n            this.pointingGestureStart(e.touches[0]);\n        }\n        e.preventDefault();\n        window.addEventListener('touchmove', this.touchMoveHandler);\n        window.addEventListener('touchend', this.touchEndHandler);\n\n    }\n\n    private mouseMove(e: MouseEvent){\n        this.pointingGestureMove(e);\n        e.preventDefault();\n    }\n\n    private mouseUp(e: MouseEvent){\n        this.pointingGestureEnd(e);\n        window.removeEventListener('mousemove', this.mouseMoveHandler);\n        window.removeEventListener('mouseup', this.mouseUpHandler);\n    }\n\n    private touchMove(e: TouchEvent){\n        if (e.touches.length > 0){\n            this.pointingGestureMove(e.touches[0]);\n            e.preventDefault();\n        }\n    }\n\n    private boundingRects(): {container: Rectangle; handle: Rectangle}{\n\n        if(!this.containerRef.current || !this.handleRef.current){\n            throw new Error(`Refs not ready`);\n        }\n\n        return {\n            container: Rectangle.fromDOMRect(this.containerRef.current.getBoundingClientRect()),\n            handle: Rectangle.fromDOMRect(this.handleRef.current.getBoundingClientRect()),\n        };\n\n    }\n\n    private touchEnd(e: TouchEvent){\n\n        if (e.touches.length > 0){\n            this.pointingGestureEnd(e.touches[0]);\n            e.preventDefault();\n        }\n\n        window.removeEventListener('touchmove', this.touchMoveHandler);\n        window.removeEventListener('touchend', this.touchEndHandler);\n    }\n\n    private pointingGestureStart(e: GestureData){\n        this.dragging = true;\n\n        // Save handle offset\n        if (this.refsReady){\n            const {handle} = this.boundingRects();\n            if (e.target === this.handleRef.current){\n                this.handleOffset = makePt(e.clientX - handle.left, e.clientY - handle.top);\n            }else{\n                this.handleOffset = makePt(handle.width/2, handle.height/2);\n            }\n\n        }\n\n        this.pointingGestureMove(e);\n\n    }\n\n    private pointingGestureEnd(e: GestureData){\n        this.dragging = false;\n    }\n\n    private pointingGestureMove(e: GestureData){\n\n        if (this.dragging && this.refsReady){\n\n            const {container, handle} = this.boundingRects();\n\n            let x = e.clientX - container.left - this.handleOffset.x;\n            x = Math.max(0, x);\n            x = Math.min(container.width - handle.width, x);\n\n            let y = e.clientY - container.top - this.handleOffset.y;\n            y = Math.max(0, y);\n            y = Math.min(container.height - handle.height, y);\n\n            this.updateHandleOffset(x, y);\n        }\n    }\n\n    private updateHandleOffset(handleOffsetX: number, handleOffsetY: number){\n\n        if (this.handleRef.current){\n            const {direction} = this.props;\n\n            if(direction !== 'vertical') {\n                this.handleRef.current.style.left = `${handleOffsetX}px`;\n            }\n\n            if(direction === 'vertical' || direction === '2d'){\n                this.handleRef.current.style.top = `${handleOffsetY}px`;\n            }\n\n        }\n\n        if (this.props.onChange){\n            this.props.onChange(this.valueFromRects());\n        }\n\n    }\n\n    private handleOffsetFromValue(value: number): number{\n\n        if (this.props.direction !== '2d'){\n            const {container, handle} = this.boundingRects();\n            const max = this.props.max as number;\n            const min = this.props.min as number;\n            const avail = container.width - handle.width;\n            const result = value * avail / (max-min);\n\n            return result;\n        }else{\n            throw new Error('TODO');\n        }\n    }\n\n    private get refsReady(): boolean {\n        return !!this.containerRef.current && !!this.handleRef.current;\n    }\n\n    render() {\n\n        const {containerStyle, handleStyle} = this.props;\n\n        return (\n            <div ref={this.containerRef}\n                 className=\"ui-range\"\n                 tabIndex={0}\n                 style={containerStyle}\n                 onMouseDown={e => this.handleMouseDown(e)}\n                 onTouchStart={e => this.handleTouchStart(e)}>\n                <div\n                    ref={this.handleRef}\n                    className=\"handle\"\n                    style={handleStyle}\n                    onMouseDown={e => this.handleMouseDown(e)}\n                    onTouchStart={e => this.handleTouchStart(e)}\n                />\n            </div>\n        );\n    }\n\n}","import * as React from \"react\";\n\nexport interface SeparatorProps{\n\n}\n\nexport class Separator extends React.Component<SeparatorProps>{\n    render(){\n        return (\n            <div className={`ui-separator`}/>\n        );\n    }\n}","import * as React from \"react\";\nimport {CSSProperties, ReactNode} from \"react\";\n\nconst DEFAULT_LENGTH = 300;\n\nexport interface DockViewProps {\n    classNames?: string;\n    sideClassNames?: string;\n    containerClassNames?: string;\n    side?: 'left' | 'right' | 'top' | 'bottom';\n    sideView?: ReactNode;\n    length?: number;\n}\n\nexport class DockView extends React.Component<DockViewProps>{\n\n    render(){\n\n        const side = this.props.side || 'left';\n        const len = this.props.length || DEFAULT_LENGTH;\n        let sideCss: CSSProperties = {};\n        let mainCss: CSSProperties = {};\n\n        switch (side) {\n            case \"left\":\n                sideCss.width = len + 'px';\n                mainCss.left = len + 'px';\n                break;\n            case \"right\":\n                sideCss.width = len + 'px';\n                mainCss.right = len + 'px';\n                break;\n            case \"top\":\n                sideCss.height = len + 'px';\n                mainCss.top = len + 'px';\n                break;\n            case \"bottom\":\n                sideCss.height = len + 'px';\n                mainCss.bottom = len + 'px';\n                break;\n        }\n\n        return (\n            <div className={`ui-dock-view side-${side} ${this.props.classNames}`}>\n                <div className={`dock-side ${this.props.sideClassNames || ''}`} style={sideCss}>{this.props.sideView}</div>\n                <div className={`main-side ${this.props.containerClassNames || ''}`} style={mainCss}>{this.props.children}</div>\n            </div>\n        );\n\n    }\n}","import * as React from \"react\";\nimport {ReactNode} from \"react\";\nimport {DockView, DockViewProps} from \"./DockView\";\n\nconst DEFAULT_TOOLBAR_SIZE = 40;\n\nexport interface ToolbarViewProps extends DockViewProps{\n    items?: ReactNode;\n    itemsCenter?: ReactNode;\n    itemsFar?: ReactNode;\n}\n\nexport class ToolbarView extends React.Component<ToolbarViewProps>{\n\n    render(){\n\n        const len = this.props.length || DEFAULT_TOOLBAR_SIZE;\n        const side = this.props.side || 'top';\n\n        return (\n            <DockView\n                {...this.props}\n                length={len}\n                classNames={`ui-toolbar-view ${this.props.classNames || ''}`}\n                side={side}\n                sideClassNames={`toolbar ${this.props.sideClassNames || ''}`}\n                sideView={<>\n                    <div className=\"items near\">{this.props.items}</div>\n                    <div className=\"items center\">{this.props.itemsCenter}</div>\n                    <div className=\"items far\">{this.props.itemsFar}</div>\n                </>}\n            >\n                {this.props.children}\n            </DockView>\n        );\n    }\n\n}","import * as React from \"react\";\nimport {OverlayProps} from \"./Overlay\";\nimport {MenuItem, MenuItemProps} from \"../items/MenuItem\";\nimport {RefObject} from \"react\";\nimport {Separator} from \"../items/Separator\";\nimport {Rectangle} from \"../helpers/Rectangle\";\nimport {Callable} from \"../helpers/hui\";\nimport {KeyCaptureStackHandler} from \"../helpers/KeyCaptureStackHandler\";\n\nexport interface MenuOverlayProps extends OverlayProps{\n    refRect: Rectangle;\n    onDismissSignal: Callable;\n    onDismissSingleSignal?: Callable;\n    parentMenuItem?: MenuItem;\n}\n\nexport interface MenuOverlayState{\n    selectedIndex?: number;\n    openIndex?: number;\n    activatedIndex?: number;\n}\n\nexport class MenuOverlay extends React.Component<MenuOverlayProps, MenuOverlayState>{\n\n    overlayRef: RefObject<HTMLDivElement> | undefined;\n\n    readonly keyCaptureId: number;\n    private childCount: number | undefined;\n    private separators: number[] = [];\n\n    constructor(props: MenuOverlayProps){\n        super(props);\n        this.overlayRef = React.createRef();\n        this.state = {};\n        this.setOpenItem = this.setOpenItem.bind(this);\n        const isActivationKey = (e: KeyboardEvent) => e.key === 'Enter' || e.key === ' ';\n        const cancelAndDo = (e: KeyboardEvent, f: Callable) => {\n            e.stopPropagation();\n            e.preventDefault();\n            f();\n        };\n\n        this.keyCaptureId = KeyCaptureStackHandler.instance.register(e => {\n            if(e.key == 'ArrowDown') {\n                cancelAndDo(e, this.selectNext.bind(this));\n\n            }else if(e.key === 'ArrowUp') {\n                cancelAndDo(e, this.selectPrev.bind(this));\n\n            }else if(e.key === 'ArrowRight' || isActivationKey(e)) {\n                cancelAndDo(e, this.openCurrentIndex.bind(this));\n\n                if(isActivationKey(e)) {\n                    this.setState({activatedIndex: this.state.selectedIndex});\n                }\n\n            }else if(e.key === 'ArrowLeft') {\n                if(\"undefined\" !== typeof this.props.parentMenuItem) {\n                    cancelAndDo(e, () => this.sendDismissSingleSignal());\n                }\n            }\n        });\n    }\n\n    closeOpenedIndex(){\n        if(\"undefined\" !== typeof this.state.openIndex) {\n            this.setState({openIndex: undefined});\n        }\n    }\n\n    componentWillUnmount(): void {\n        KeyCaptureStackHandler.instance.unregister(this.keyCaptureId);\n    }\n\n    selectNext(){\n\n        let current = -1;\n\n        if(\"number\" === typeof this.state.selectedIndex) {\n            current = this.state.selectedIndex;\n        }\n\n        let next = current + 1;\n\n        while(\"undefined\" !== typeof this.separators.find(i => i === next)) {\n            next++;\n        }\n\n        if(\"undefined\" !== typeof this.childCount && next >= this.childCount) {\n            next = 0;\n        }\n\n        this.setState({selectedIndex: next});\n    }\n\n    selectPrev(){\n\n        let current = -1;\n\n        if(\"number\" === typeof this.state.selectedIndex) {\n            current = this.state.selectedIndex;\n        }\n\n        let prev = current - 1;\n\n        while(\"undefined\" !== typeof this.separators.find(i => i === prev)) {\n            prev--;\n        }\n\n        if(prev < 0) {\n            if(\"undefined\" !== typeof this.childCount) {\n                prev = this.childCount - 1;\n            }else{\n                prev = 0;\n            }\n        }\n\n        this.setState({selectedIndex: prev});\n    }\n\n    openCurrentIndex(){\n        if(\"undefined\" !== typeof this.state.selectedIndex) {\n            this.setOpenItem(this.state.selectedIndex);\n        }\n    }\n\n    correctPosition(){\n        if(!(this.overlayRef && this.overlayRef.current)) {\n            return;\n        }\n\n        const rect = Rectangle.fromDOMRect(this.overlayRef.current.getBoundingClientRect());\n        const view = {width: window.innerWidth, height: window.innerHeight};\n        const refRect = this.props.refRect;\n        let newRectangle = rect.clone();\n\n        if(rect.right > view.width) {\n            newRectangle = newRectangle.withRight(refRect.right);\n        }\n\n        if(rect.bottom > view.height) {\n            newRectangle = newRectangle.withBottom(view.height);\n        }\n\n        if(!newRectangle.equals(rect)) {\n            this.overlayRef.current.style.left = newRectangle.left + 'px';\n            this.overlayRef.current.style.top  = newRectangle.top  + 'px';\n        }\n    }\n\n    setNoOpenItem(){\n        this.setState({selectedIndex: undefined});\n    }\n\n    setOpenItem(index: number){\n        this.setState({selectedIndex: index, openIndex: index});\n    }\n\n    setSelectedItem(index: number){\n        this.setState({selectedIndex: index});\n    }\n\n    render(){\n        const st = {\n            top: this.props.top + 'px',\n            left: this.props.left + 'px',\n            width: `auto`,\n            height: `auto`,\n        };\n\n        if(\"number\" === typeof this.props.height) {\n            st.height = this.props.height + 'px';\n        }\n\n        if(\"number\" === typeof this.props.width) {\n            st.width = this.props.width + 'px';\n        }\n\n        setTimeout(() => {\n            this.correctPosition();\n        });\n\n        this.childCount = React.Children.count(this.props.children);\n\n        this.separators = []; // Reset to collect on .map bellow\n\n        return <div ref={this.overlayRef} className={`ui-overlay ui-menu-overlay`} style={st}>\n            {React.Children.map(this.props.children, (menuItem: React.ReactElement<MenuItemProps>, index) => {\n                if(menuItem.type === Separator) {\n                    this.separators.push(index);\n                }\n                return React.cloneElement(menuItem, {\n                    onOpen: () => this.setOpenItem(index),\n                    onClose: () => this.setNoOpenItem(),\n                    onDismissSignal: () => this.sendDismissSignal(),\n                    onDismissSingleSignal: () => this.closeOpenedIndex(),\n                    onSelectSignal: () => this.setSelectedItem(index),\n                    isSelected: index === this.state.selectedIndex,\n                    isOpen: index === this.state.openIndex,\n                    isActivated: index === this.state.activatedIndex,\n                    parent: this,\n                });\n            })}\n        </div>;\n    }\n\n    sendDismissSignal(){\n        if(this.props.onDismissSignal) {\n            this.props.onDismissSignal();\n        }\n    }\n\n    sendDismissSingleSignal(){\n        if(this.props.onDismissSingleSignal) {\n            this.props.onDismissSingleSignal();\n        }\n    }\n}","import './hui/css/styles.css';\nimport './hui/css/theme.css';\nimport './hui/css/index.scss';\nimport './index.scss';\nimport * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport {App} from \"./components/App\";\n\nReactDOM.render(\n    <App />,\n    document.getElementById(`root`)\n);","\nexport function readInt16LE(arr: Uint8ClampedArray, offset: number): number{\n    return (arr[offset + 1] << 8) | arr[offset];\n}\n\nexport function readInt32LE(arr: Uint8ClampedArray, offset: number): number{\n    const d = arr[offset + 3];\n    const c = arr[offset + 2];\n    const b = arr[offset + 1];\n    const a = arr[offset];\n    return (d << 24) | (c << 16) | (b << 8) | a;\n}\n\nexport function writeInt32LE(arr: Uint8ClampedArray, offset: number, n: number){\n    arr[offset] = n & 0xff;\n    arr[offset + 1] = (n & 0xff00) >>> 8;\n    arr[offset + 2] = (n & 0xff0000) >>> 16;\n    arr[offset + 3] = (n & 0xff000000) >>> 24;\n}\n\nexport class BlobComposer{\n\n    private data: Uint8ClampedArray = new Uint8ClampedArray(0);\n\n    getBlob(props?: BlobPropertyBag): Blob{\n        return new Blob([this.data.buffer], props);\n    }\n\n    async writeBlob(blob: Blob){\n        this.writeBuffer(await blob.arrayBuffer());\n    }\n\n    writeBuffer(buff: ArrayBuffer){\n        this.writeUint8Clamped(new Uint8ClampedArray(buff));\n    }\n\n    writeUint8Clamped(arr: Uint8ClampedArray){\n        const data = new Uint8ClampedArray(this.data.length + arr.length);\n        data.set(this.data, 0);\n        data.set(arr, this.data.length);\n        this.data = data;\n    }\n\n    writeInt32LE(n: number){\n        this.writeUint8Clamped(new Uint8ClampedArray([\n            (n & 0xff),\n            (n & 0xff00) >>> 8,\n            (n & 0xff0000) >>> 16,\n            (n & 0xff000000) >>> 24,\n        ]));\n    }\n\n    writeInt16LE(n: number){\n        this.writeUint8Clamped(new Uint8ClampedArray([\n            (n & 0xff),\n            (n & 0xff00) >>> 8,\n        ]));\n    }\n\n}","\nconst MIME_PNG = \"image/png\";\n\nexport class ClipboardEmptyError extends Error{}\n\nexport class ClipboardService {\n\n    private static buffer: Blob | null;\n\n    static async copyBlob(blob: Blob, mime: string): Promise<void> {\n\n        try{\n            await this.systemCopyBlob(blob, mime);\n        }catch(e){\n            this.buffer = blob;\n        }\n\n    }\n\n    static async pasteBlob(): Promise<Blob> {\n        try{\n            return await this.systemPasteBlob();\n        }catch(e){\n            if (this.buffer){\n                return this.buffer;\n            }else{\n                return Promise.reject(new ClipboardEmptyError());\n            }\n        }\n    }\n\n    static async systemCopyBlob(blob: Blob, mime: string): Promise<void> {\n\n        const ctorName = 'ClipboardItem';\n\n        if (ctorName in window){\n            const ctor: any = (window as any)[ctorName]; // Workaround: currently not in TS library.\n            const item = new ctor({[mime]: blob});\n            const data = [item];\n\n            try{\n                await (navigator.clipboard as any).write(data);\n            }catch(e){\n                return Promise.reject(`Error writing data to clipboard`);\n            }\n\n        }else{\n            return Promise.reject(`No compatibility for clipboard copying`);\n        }\n\n    }\n\n    static async systemPasteBlob(): Promise<Blob> {\n        const data: any | undefined = await (navigator.clipboard as any).read();\n        let warnings: string[] = [];\n\n        if (data && data.length > 0){\n\n            for(let i = 0; i < data.length; i++){\n\n                const item = data[i];\n                const types: string[] = data[i].types;\n\n                if (types.indexOf(MIME_PNG) >= 0){\n                    const blob: Blob = await item.getType(MIME_PNG);\n\n                    if (blob){\n                        return blob;\n                    }else{\n                        warnings.push(`Can't read ${item.type} from clipboard`);\n                    }\n\n                    break;\n                }else{\n                    warnings.push(`Unsupported MIME: ${item.type}`);\n                }\n            }\n        }else{\n            return Promise.reject(new ClipboardEmptyError());\n        }\n\n        return Promise.reject(warnings);\n    }\n\n\n}","\ninterface EditorTransaction<T>{\n    documentState: T;\n}\n\nexport class NoTransactionError extends Error{}\nexport class TransactionInProgressError extends Error{}\nexport class UnsavedChangesError extends Error{}\n\nexport class Editor<T>{\n\n    private _currentTransaction: EditorTransaction<T> | null = null;\n    private _document: T;\n    private _hasChanges: boolean = false;\n\n    private readonly undoStack: EditorTransaction<T>[] = [];\n    private readonly redoStack: EditorTransaction<T>[] = [];\n\n    public documentChanged: (() => void) | null = null;\n    public documentSubmitted: (() => void) | null = null;\n\n    constructor(document: T) {\n        this._document = document;\n    }\n\n    redo(): boolean{\n\n        if (this.redoStack.length == 0){\n            return false;\n        }\n\n        const top = this.redoStack.pop();\n\n        if (top){\n            this.undoStack.push({documentState: this.document!});\n            this._document = top.documentState;\n\n            if (this.documentSubmitted){\n                this.documentSubmitted();\n            }\n        }\n\n        return true;\n\n    }\n\n    undo(): boolean{\n\n        if (this.undoStack.length == 0){\n            return false;\n        }\n\n        const top = this.undoStack.pop();\n\n        if (top){\n            this.redoStack.push({documentState: this.document!});\n            this._document = top.documentState;\n\n            if (this.documentSubmitted){\n                this.documentSubmitted();\n            }\n        }\n\n        return true;\n    }\n\n    begin(){\n\n        if (this._currentTransaction){\n            throw new TransactionInProgressError();\n        }else{\n            this._currentTransaction = {documentState: this._document};\n        }\n    }\n\n    setDocument(document: T){\n        if (this._currentTransaction){\n            this._document = document;\n\n            if (this.documentChanged){\n                this.documentChanged();\n            }\n\n        }else{\n            throw new NoTransactionError();\n        }\n\n    }\n\n    commit(document?: T){\n\n        if (!this._currentTransaction){\n            throw new NoTransactionError();\n        }\n\n        if (document){\n            this.setDocument(document);\n        }\n\n        // Push to undo stack\n        this.undoStack.push(this._currentTransaction);\n\n        // Clear transaction\n        this._currentTransaction = null;\n\n        // Empty redo stack\n        while(this.redoStack.length > 0) {this.redoStack.pop()}\n\n        // We have changes\n        this._hasChanges = true;\n\n        if (this.documentSubmitted){\n            this.documentSubmitted();\n        }\n    }\n\n    rollback(){\n\n        if (this._currentTransaction){\n            this._document = this._currentTransaction.documentState;\n            this._currentTransaction = null;\n\n            if (this.documentSubmitted){\n                this.documentSubmitted();\n            }\n\n        }else{\n            throw new NoTransactionError();\n        }\n\n    }\n\n    clearChanges(){\n        this._hasChanges = false;\n    }\n\n    transact(document: T){\n        this.begin();\n        this.commit(document);\n    }\n\n    get currentTransaction(): EditorTransaction<T> | null{\n        return this._currentTransaction;\n    }\n\n    get document(): T{\n        return this._document;\n    }\n\n    get hasChanges(): boolean{\n        return this._hasChanges;\n    }\n\n    get redoCount(): number{\n        return this.redoStack.length;\n    }\n\n    get redoPeek(): T | null{\n        if (this.redoStack.length > 0){\n            return this.redoStack[this.redoStack.length - 1].documentState;\n        }\n        return null;\n    }\n\n    get undoCount(): number{\n        return this.undoStack.length;\n    }\n\n    get undoPeek(): T | null{\n        if (this.undoStack.length > 0){\n            return this.undoStack[this.undoStack.length - 1].documentState;\n        }\n        return null;\n    }\n\n}","import {\n    CanvasViewController,\n    KeyEvent,\n    KeyEventResult,\n    PointingEvent,\n    PointingEventResult\n} from \"../components/CanvasView\";\nimport {IconDocument, IconEditor, IconEditorTool} from \"./IconEditor\";\nimport {PencilTool} from \"./tools/PencilTool\";\nimport {IconService} from \"./IconService\";\nimport {IconDocumentRenderer} from \"./IconDocumentRenderer\";\nimport {makePt, makeSz, Point, Rectangle, Size} from \"../hui/helpers/Rectangle\";\nimport {SelectionTool} from \"./tools/SelectionTool\";\nimport {Icon} from \"./Icon\";\nimport {ClipboardEmptyError, ClipboardService} from \"./ClipboardService\";\nimport {NoSelectionError} from \"./errors\";\n\nconst MIME_PNG = \"image/png\";\n\nexport interface PasteResult{\n    tool?: IconEditorTool;\n    success: boolean;\n    warnings: string[];\n}\n\nexport type DownloadFormat = 'png' | 'ico';\n\nexport class IconCanvasController implements CanvasViewController{\n\n    showBackground = false;\n    showGrid = false;\n\n    readonly editor: IconEditor;\n    private _tool: IconEditorTool | null = new PencilTool(this);\n    private previewBounds: Rectangle = Rectangle.empty;\n    private previewPixelSize: number = 0;\n\n    constructor(document?: IconDocument) {\n\n        if (document){\n            this.editor = new IconEditor(document);\n        }else{\n            this.editor = new IconEditor({\n                icon: IconService.newIcon(16, 16)\n            });\n        }\n\n        (window as any)._editor = this.editor;\n    }\n\n    async copy(): Promise<void>{\n\n        if (!this.editor.document.selectionSprite){\n            return Promise.resolve();\n        }\n\n        const blob = await IconService.asBlobWithMime(this.editor.document.selectionSprite, MIME_PNG);\n\n        return ClipboardService.copyBlob(blob, MIME_PNG);\n\n    }\n\n    async cut(): Promise<void>{\n\n        if (!this.editor.document.selectionBuffer){\n            throw new NoSelectionError();\n        }\n\n        try{\n            await this.copy();\n\n            this.editor.transact({\n                ...this.editor.cloneDocument(),\n                icon: this.editor.document.selectionBuffer,\n                selectionRegion: undefined,\n                selectionSprite: undefined,\n                selectionBuffer: undefined,\n            });\n\n        }catch(e){\n            return Promise.reject(e);\n        }\n\n    }\n\n    async paste(): Promise<PasteResult>{\n\n        let success = false;\n        let tool: IconEditorTool | undefined;\n        let warnings: string[] = [];\n\n        try{\n            const blob = await ClipboardService.pasteBlob();\n            tool = await this.importFile(blob);\n            success = true;\n\n        }catch(e){\n            if (e instanceof ClipboardEmptyError){\n              return Promise.reject(e);\n\n            }else if(e instanceof Array){\n                warnings = [...e];\n            }\n        }\n\n\n        return {success, tool, warnings};\n    }\n\n    async downloadAs(format: DownloadFormat, icons: Icon[] | null = null): Promise<void>{\n\n        let blob: Blob;\n        let name: string;\n\n        if (format == 'png'){\n            blob = await IconService.asBlobWithMime(this.editor.document.icon, MIME_PNG);\n            name = `favicon.png`;\n        }else{\n            blob = await IconService.asIcoBlob(icons || [this.editor.document.icon]);\n            name = 'favicon.ico'\n        }\n\n        const a = document.createElement('a');\n\n        a.href = URL.createObjectURL(blob);\n        a.download = name;\n        a.click();\n\n    }\n\n    async importFile(file: Blob): Promise<SelectionTool>{\n        const icon = this.editor.document.icon;\n        const size = makeSz(icon.width, icon.height);\n        const sprite = await IconService.fromFile(file, size);\n\n        this.pasteSprite(sprite);\n\n        if (this.tool instanceof SelectionTool){\n            return this.tool;\n        }\n\n        const tool = new SelectionTool(this);\n        this.tool = tool;\n        return tool;\n    }\n\n    pasteSprite(sprite: Icon){\n\n        const newDoc = this.editor.cloneDocument();\n        const containerRec = new Rectangle(0 ,0, newDoc.icon.width, newDoc.icon.height);\n        const spriteRect = new Rectangle(0, 0, sprite.width, sprite.height)\n            .centerAt(containerRec.center).round();\n\n        newDoc.selectionRegion = spriteRect;\n        newDoc.selectionSprite = sprite;\n        newDoc.selectionBuffer = newDoc.icon;\n        newDoc.icon = IconService.blend(newDoc.selectionBuffer, newDoc.selectionSprite, newDoc.selectionRegion);\n\n        this.editor.begin();\n        this.editor.setDocument(newDoc);\n        this.editor.commit();\n    }\n\n    pixelToData(pixel: Point): number{\n        const icon = this.editor.document.icon;\n        return icon.width * 4 * pixel.y + pixel.x * 4;\n    }\n\n    pointToPixel(p: Point): Point | null{\n        if (!this.previewBounds.contains(p)){\n            return null;\n        }\n\n        const left = p.x - this.previewBounds.left;\n        const top = p.y - this.previewBounds.top;\n\n        return makePt(\n            Math.floor(left / this.previewPixelSize),\n            Math.floor(top / this.previewPixelSize)\n        );\n    }\n\n    pointToData(p: Point): number{\n\n        // Deflation prevents round-errors\n        if (!this.previewBounds.deflate(1, 1).contains(p)){\n            return - 1;\n        }\n\n        const pixel = this.pointToPixel(p);\n\n        if (pixel){\n            return this.pixelToData(pixel);\n        }\n\n        return -1;\n\n    }\n\n    pointingGestureStart(e: PointingEvent): PointingEventResult | void {\n        if (this.tool?.pointingGestureStart){\n            return this.tool.pointingGestureStart(e);\n        }\n    }\n\n    pointingGestureMove(e: PointingEvent): PointingEventResult | void {\n        if (this.tool?.pointingGestureMove){\n            return this.tool.pointingGestureMove(e);\n        }\n    }\n\n    pointingGestureEnd(e: PointingEvent): PointingEventResult | void {\n        if (this.tool?.pointingGestureEnd){\n            return this.tool.pointingGestureEnd(e);\n        }\n    }\n\n    keyDown(e: KeyEvent): KeyEventResult | void{\n        if (this.tool?.keyDown){\n            return this.tool.keyDown(e);\n        }\n    }\n\n    keyUp(e: KeyEvent): KeyEventResult | void{\n        if (this.tool?.keyUp){\n            return this.tool.keyUp(e);\n        }\n    }\n\n    render(context: CanvasRenderingContext2D, size: Size){\n\n        const cvBounds = new Rectangle(0, 0, size.width, size.height);\n        const previewArea = cvBounds.deflate(10, 10);\n\n        if (this.editor.document){\n\n            const icon = this.editor.document.icon;\n            const pixelLength = this.previewPixelSize = Math.min(previewArea.size.width, previewArea.size.height) / Math.min(icon.width, icon.height);\n\n            this.previewBounds = new Rectangle(\n                0, 0,\n                icon.width * pixelLength,\n                icon.height *  pixelLength)\n                .centerAt(makePt(cvBounds.center.x, (icon.height * pixelLength)/2));\n\n            const renderer = new IconDocumentRenderer(\n                this.editor.document,\n                context,\n                this.previewBounds,\n                this.showBackground,\n                this.showGrid,\n                );\n\n            renderer.render();\n        }\n    }\n\n    get tool(): IconEditorTool | null{\n        return this._tool;\n    }\n\n    set tool(value: IconEditorTool | null){\n\n        if(value === this._tool){\n            return;\n        }\n\n        if (this._tool?.deactivate){\n            this._tool.deactivate();\n        }\n\n        this._tool = value;\n\n        if (this._tool?.activate){\n            this._tool.activate();\n        }\n    }\n}","import {IconDocument} from \"./IconEditor\";\nimport {makeSz, Rectangle, Size} from \"../hui/helpers/Rectangle\";\nimport {Color} from \"../hui/helpers/Color\";\nimport {MemoryError} from \"./errors\";\n\nconst GRID_OUT = Color.fromHex(`#d0d0d0`);\nconst GRID_INT = Color.fromHex(`#e0e0e0`);\nconst CHECKER_EVEN = Color.transparent;\nconst CHECKER_ODD = Color.fromHex(`#f0f0f0`);\nconst CHECKER_SIZE = 20;\n\nconst CLOCK_MOD = 4;\nconst SAFE_CLEAR = 10;\n\nexport class IconDocumentRenderer {\n\n    private static clock = 0;\n    private static clockReminder = 0;\n    private static checkerCanvas: HTMLCanvasElement | null = null;\n    private static pixelsBuffer: HTMLCanvasElement | null = null;\n    private static pixelsContext: CanvasRenderingContext2D | null = null;\n\n    static getPixelsBuffer(canvasSize: Size): {canvas: HTMLCanvasElement; cx: CanvasRenderingContext2D}{\n        if(\n            !this.pixelsBuffer ||\n            this.pixelsBuffer.width !== canvasSize.width ||\n            this.pixelsBuffer.height !== canvasSize.height\n        ) {\n            this.pixelsBuffer = document.createElement('canvas');\n            this.pixelsBuffer.width = canvasSize.width;\n            this.pixelsBuffer.height = canvasSize.height;\n            this.pixelsContext = this.pixelsBuffer.getContext('2d');\n        }\n\n        if(!this.pixelsContext) {\n            throw new MemoryError();\n        }\n\n        return {\n            canvas: this.pixelsBuffer,\n            cx: this.pixelsContext,\n        }\n    }\n\n    static getPattern(context: CanvasRenderingContext2D): CanvasPattern | null{\n\n        if(!IconDocumentRenderer.checkerCanvas){\n            const canvas: HTMLCanvasElement = IconDocumentRenderer.checkerCanvas = document.createElement('canvas');\n            canvas.width = canvas.height = CHECKER_SIZE;\n\n            const localCx = canvas.getContext('2d');\n            const size = CHECKER_SIZE / 2;\n\n            if(!localCx){\n                return null;\n            }\n\n            if (!CHECKER_EVEN.isTransparent){\n                localCx.fillStyle = CHECKER_EVEN.cssRgba;\n                localCx.fillRect(0,0, size, size);\n                localCx.fillRect(size, size, size, size);\n            }\n\n            if (!CHECKER_ODD.isTransparent){\n                localCx.fillStyle = CHECKER_ODD.cssRgba;\n                localCx.fillRect(size, 0, size, size);\n                localCx.fillRect(0, size, size, size);\n            }\n        }\n\n        const canvas = IconDocumentRenderer.checkerCanvas;\n\n        return context.createPattern(canvas, 'repeat');\n\n    }\n\n    constructor(\n        readonly document: IconDocument,\n        readonly context: CanvasRenderingContext2D,\n        readonly bounds: Rectangle,\n        readonly drawBackground: boolean,\n        readonly drawGrid: boolean,\n    ) {}\n\n    private rectStroke(r: Rectangle, color: Color){\n        this.context.strokeStyle = color.cssRgba;\n        this.context.strokeRect(...r.tuple);\n    }\n\n    private rectFill(r: Rectangle, color: Color){\n        this.context.fillStyle = color.cssRgba;\n        this.context.fillRect(...r.tuple);\n    }\n\n    private renderPixels_Deprecated(pixelSize: Size){\n\n        const data = this.document.icon.data;\n        let x = this.bounds.left;\n        let y = this.bounds.top;\n        let drawn = 0;\n\n\n        for(let i = 0; i < data.length; i += 4){\n            const color = new Color(data[i], data[i + 1], data[i + 2], data[i + 3] / 255);\n            const r = new Rectangle(x, y, pixelSize.width, pixelSize.height);\n            this.rectFill(r, color);\n\n            drawn++;\n            x += pixelSize.width;\n\n            if ((drawn % this.document.icon.width) === 0){\n                y += pixelSize.height;\n                x = this.bounds.left;\n            }\n\n        }\n\n    }\n\n    private renderPixels(pixelSize: Size){\n        const {canvas, cx} = IconDocumentRenderer.getPixelsBuffer(makeSz(this.document.icon.width, this.document.icon.height));\n\n        cx.putImageData(new ImageData(this.document.icon.data, this.document.icon.width), 0, 0);\n\n        this.context.imageSmoothingEnabled = false;\n        this.context.drawImage(canvas, ...this.bounds.tuple);\n        this.context.imageSmoothingEnabled = true;\n    }\n\n    private renderGrid(pixelSize: Size){\n\n        const ctx = this.context;\n        const icon = this.document.icon;\n        const bounds = this.bounds;\n\n        ctx.beginPath();\n\n        let x = this.bounds.left;\n        let y = this.bounds.top;\n\n        for(let i = 0; i < icon.width; i++){\n            ctx.moveTo(x, bounds.top);\n            ctx.lineTo(x, bounds.bottom);\n            x += pixelSize.width;\n        }\n\n        for(let i = 0; i < icon.height; i++){\n            ctx.moveTo(bounds.left, y);\n            ctx.lineTo(bounds.right, y);\n            y += pixelSize.height;\n        }\n\n        ctx.strokeStyle = GRID_INT.cssRgba;\n        ctx.stroke();\n\n    }\n\n    private renderFrame(){\n        this.rectStroke(this.bounds, GRID_OUT);\n    }\n\n    private renderChecker(){\n        const pattern = IconDocumentRenderer.getPattern(this.context);\n\n        if(!pattern){\n            return;\n        }\n\n        this.context.fillStyle = pattern;\n        this.context.fillRect(...this.bounds.tuple);\n\n    }\n\n    private renderSelection(pixelSize: Size){\n\n        if (!this.document.selectionRegion){\n            return;\n        }\n\n        const selection = this.document.selectionRegion;\n\n        const selBounds = new Rectangle(\n            this.bounds.left + selection.left * pixelSize.width,\n            this.bounds.top + selection.top * pixelSize.height,\n            selection.width * pixelSize.width,\n            selection.height * pixelSize.height\n        ).round();\n\n        IconDocumentRenderer.clock++;\n\n        if(IconDocumentRenderer.clock % CLOCK_MOD === 0){\n            IconDocumentRenderer.clockReminder++;\n\n            if (IconDocumentRenderer.clockReminder === 9){\n                IconDocumentRenderer.clockReminder = 0;\n            }\n        }\n\n        // this.context.strokeStyle = '#000';\n        // this.context.strokeRect(...selBounds.tuple);\n\n\n\n        const fives = new Array(Math.round(selBounds.width / 5)).fill(5);\n\n        const segmentedRect = (r: Rectangle) => {\n            // Drawing the rect like this prevents weird behavior\n            // of the segmented pattern\n            this.context.beginPath();\n            this.context.moveTo(r.left, r.top);\n            this.context.lineTo(r.right, r.top);\n            this.context.moveTo(r.right, r.bottom);\n            this.context.lineTo(r.left, r.bottom);\n            this.context.stroke();\n\n            this.context.beginPath();\n            this.context.moveTo(r.right, r.top);\n            this.context.lineTo(r.right, r.bottom);\n            this.context.moveTo(r.left, r.bottom);\n            this.context.lineTo(r.left, r.top);\n            this.context.stroke();\n        }\n\n        // =00000====\n        // ==00000===\n        // ===00000==\n        // ====00000=\n        // =====00000\n\n        const lineWidthBuffer = this.context.lineWidth;\n        this.context.lineWidth = 1.5;\n\n        switch(IconDocumentRenderer.clockReminder){\n            case 0: this.context.setLineDash([1, ...fives]); break;\n            case 1: this.context.setLineDash([2, ...fives]); break;\n            case 2: this.context.setLineDash([3, ...fives]); break;\n            case 3: this.context.setLineDash([4, ...fives]); break;\n            case 4: this.context.setLineDash([5, 5]); break;\n            case 5: this.context.setLineDash([0, 1,...fives]); break;\n            case 6: this.context.setLineDash([0,2,...fives]); break;\n            case 7: this.context.setLineDash([0,3,...fives]); break;\n            case 8: this.context.setLineDash([0,4,...fives]); break;\n        }\n        this.context.strokeStyle = '#fff';\n\n        segmentedRect(selBounds);\n\n\n        switch(IconDocumentRenderer.clockReminder){\n            case 0: this.context.setLineDash([0, 1, ...fives]); break;\n            case 1: this.context.setLineDash([0, 2, ...fives]); break;\n            case 2: this.context.setLineDash([0, 3, ...fives]); break;\n            case 3: this.context.setLineDash([0, 4, ...fives]); break;\n            case 4: this.context.setLineDash([0, 5, ...fives]); break;\n            case 5: this.context.setLineDash([1,...fives]); break;\n            case 6: this.context.setLineDash([2,...fives]); break;\n            case 7: this.context.setLineDash([3,...fives]); break;\n            case 8: this.context.setLineDash([4,...fives]); break;\n        }\n        this.context.strokeStyle = '#000';\n        segmentedRect(selBounds);\n\n\n        this.context.setLineDash([]);\n        this.context.lineWidth = lineWidthBuffer;\n\n    }\n\n    render(){\n        const pixelSize = makeSz(\n            this.bounds.width / this.document.icon.width,\n            this.bounds.height / this.document.icon.height);\n\n        this.context.clearRect(...this.bounds.inflate(SAFE_CLEAR, SAFE_CLEAR).tuple);\n\n        if (this.drawBackground){\n            this.renderChecker();\n        }\n\n        this.renderPixels(pixelSize);\n\n        if (this.drawGrid){\n            this.renderGrid(pixelSize);\n        }\n\n        this.renderFrame();\n\n        if (this.document.selectionRegion){\n            this.renderSelection(pixelSize);\n        }\n\n    }\n\n}","import {Icon} from \"./Icon\";\nimport {Editor} from \"./Editor\";\nimport {CanvasSensor} from \"../components/CanvasView\";\nimport {Rectangle} from \"../hui/helpers/Rectangle\";\nimport {IconService} from \"./IconService\";\n\n\n\ndeclare interface ClipboardItem{\n    ClipboardItem: (data: any) => ClipboardItem;\n}\n\nexport interface IconDocument{\n    icon: Icon;\n    selectionRegion?: Rectangle;\n    selectionBuffer?: Icon;\n    selectionSprite?: Icon;\n}\n\nexport interface IconEditorTool extends CanvasSensor{\n    activate?: () => void;\n    deactivate?: () => void;\n}\n\nexport class IconEditor extends Editor<IconDocument>{\n\n    cloneDocument(): IconDocument{\n\n        const doc = this.document;\n\n        const newDocument = {\n            ...doc,\n            icon: IconService.clone(this.document.icon),\n        };\n\n        return newDocument;\n    }\n\n}","import {Icon, IconColorModel} from \"./Icon\";\nimport {makePt, makeSz, Point, Rectangle, scaleToContain, Size} from \"../hui/helpers/Rectangle\";\nimport {Color} from \"../hui/helpers/Color\";\nimport {InvalidRegionError, MemoryError} from \"./errors\";\nimport {ImageService} from \"./ImageService\";\nimport {BlobComposer, readInt16LE, readInt32LE, writeInt32LE} from \"./BlobComposer\";\n\nconst sizeICONDIR = 6;\nconst sizeICONDIRENTRY = 16;\n\nexport interface IconDirectory{\n    icons: Icon[];\n}\n\nexport class IconService{\n\n    static clone(icon: Icon): Icon{\n        return {...icon, data: new Uint8ClampedArray(icon.data)};\n    }\n\n    static asCanvas(icon: Icon): HTMLCanvasElement{\n\n        const canvas: HTMLCanvasElement = document.createElement('canvas');\n        canvas.width = icon.width;\n        canvas.height = icon.height;\n\n        const cx = canvas.getContext('2d');\n\n        if (!cx){\n            throw new MemoryError();\n        }\n\n        cx.putImageData(this.asImageData(icon), 0, 0);\n\n        return canvas;\n\n    }\n\n    static asBlobWithMime(icon: Icon, mime: string = 'image/png'): Promise<Blob>{\n        return new Promise<Blob>((resolve, reject) => {\n\n            const canvas = this.asCanvas(icon);\n\n            canvas.toBlob(blob => {\n                if (blob){\n                    resolve(blob);\n                }else{\n                    reject(new MemoryError());\n                }\n            }, mime);\n\n        });\n    }\n\n    static async asBlobUrl(icon: Icon, mime: string = 'image/png'): Promise<string>{\n        const blob = await this.asBlobWithMime(icon, mime);\n        return URL.createObjectURL(blob);\n    }\n\n    static async asIcoBlob(icons: Icon[]): Promise<Blob>{\n\n        const composer = new BlobComposer();\n        const pngBlobs: Blob[] = [];\n        let pngBlobSum = 0;\n\n        // ICONDIR structure\n        composer.writeUint8Clamped(new Uint8ClampedArray([\n            0, 0, // 2B\tReserved. Must always be 0.\n            1, 0, // 2B Specifies image type: 1 for icon (.ICO) image, 2 for cursor (.CUR) image. Other values are invalid.\n        ]));\n\n        composer.writeInt16LE(icons.length); // 2b Specifies number of images in the file.\n\n        for (const icon of icons){\n            const pngBlob = await this.asBlobWithMime(icon, 'image/png');\n            pngBlobs.push(pngBlob);\n\n            console.log(`PNG Blob: ${pngBlob.size}`);\n\n            // ICONDIRENTRY\n            composer.writeUint8Clamped(new Uint8ClampedArray([\n                icon.width === 256 ? 0 : icon.width,    // 1B Specifies image width in pixels. Can be any number between 0 and 255. Value 0 means image width is 256 pixels.\n                icon.height === 256 ? 0 : icon.height,  // 1B Specifies image height in pixels. Can be any number between 0 and 255. Value 0 means image height is 256 pixels.\n                0,                                      // 1B Specifies number of colors in the color palette. Should be 0 if the image does not use a color palette.\n                0,                                      // 1B Reserved. Should be 0\n                1, 0,                                   // 2B Specifies color planes. Should be 0 or 1\n                8, 0,                                   // 2B Specifies bits per pixel\n            ]));\n\n            const dataOffset = sizeICONDIR + sizeICONDIRENTRY * icons.length + pngBlobSum;\n\n            composer.writeInt32LE(pngBlob.size);    // 4B Specifies the size of the image's data in bytes\n            composer.writeInt32LE(dataOffset);      // 4B Specifies the offset of BMP or PNG data from the beginning of the ICO/CUR file\n\n            pngBlobSum += pngBlob.size;\n        }\n\n        for(const b of pngBlobs){\n            await composer.writeBlob(b);\n        }\n\n        return composer.getBlob();\n    }\n\n    static async fromIcoBlob(blob: Blob): Promise<IconDirectory>{\n\n        const icons: Icon[] = [];\n\n        const buffer = await blob.arrayBuffer();\n        const array = new Uint8ClampedArray(buffer);\n        const iconCount = readInt16LE(array, 4);\n\n        for(let i = 0; i < iconCount; i++){\n\n            const dirEntryStart = sizeICONDIR + sizeICONDIRENTRY * i;\n            const dirEntry = array.slice(dirEntryStart, dirEntryStart + sizeICONDIRENTRY);\n            const dataSize = readInt32LE(dirEntry, 8);\n            const dataOffset = readInt32LE(dirEntry, 12);\n            const data = array.slice(dataOffset, dataOffset + dataSize);\n            const composer = new BlobComposer();\n\n            // ICONDIR structure\n            composer.writeUint8Clamped(new Uint8ClampedArray([\n                0, 0, // 2B\tReserved. Must always be 0.\n                1, 0, // 2B Specifies image type: 1 for icon (.ICO) image, 2 for cursor (.CUR) image. Other values are invalid.\n                1, 0, // 2B Specifies number of images in the file.\n            ]));\n\n            // Update offset\n            writeInt32LE(dirEntry, 12, 22);\n\n            composer.writeUint8Clamped(dirEntry);\n            composer.writeUint8Clamped(data);\n\n            const blob = composer.getBlob({type: \"image/x-icon\"});\n            const image = await ImageService.fromFile(blob);\n\n            icons.push(IconService.fromImage(image));\n\n        }\n\n        return {icons};\n    }\n\n    static asImageData(icon: Icon): ImageData{\n        return new ImageData(icon.data, icon.width);\n    }\n\n    static fromCanvas(canvas: HTMLCanvasElement, cx: CanvasRenderingContext2D | null = null): Icon{\n\n        if (!cx){\n            cx = canvas.getContext('2d');\n        }\n\n        if (!cx) {\n            throw new MemoryError();\n        }\n\n        const model: IconColorModel = 'rgba';\n        const width = canvas.width;\n        const height = canvas.height;\n        const imageData = cx.getImageData(0,0,width, height);\n        const data = imageData.data;\n\n        return {width, height, model, data};\n    }\n\n    static fromIcon(icon: Icon, region: Rectangle): Icon{\n\n        const data = new Uint8ClampedArray(region.width * region.height * 4);\n\n        this.region32(icon, region, (index, current) => {\n            data[current] = icon.data[index];\n            data[current + 1] = icon.data[index + 1];\n            data[current + 2] = icon.data[index + 2];\n            data[current + 3] = icon.data[index + 3];\n        });\n\n        return {\n            width: region.width,\n            height: region.height,\n            data,\n            model: `rgba`\n        }\n    }\n\n    static fromImage(image: HTMLImageElement, newSize?: Size): Icon{\n\n        const model: IconColorModel = 'rgba';\n        const width = newSize? newSize.width : image.naturalWidth;\n        const height = newSize? newSize.height : image.naturalHeight;\n        const data = ImageService.resize(image, makeSz(width, height));\n\n        return {width, height, model, data};\n\n    }\n\n    static async fromFile(file: Blob, contain?: Size, allowScaleUp = false): Promise<Icon>{\n\n        const image = await ImageService.fromFile(file);\n        let width = image.width;\n        let height = image.height;\n\n        if (contain){\n            const actual = makeSz(width, height);\n            const contained = (actual.width > contain.width && actual.height > contain.height) || allowScaleUp ?  scaleToContain(contain, actual) : actual;\n            width = Math.round(contained.width);\n            height = Math.round(contained.height);\n        }\n\n        return this.fromImage(image, makeSz(width, height));\n\n    }\n\n    static newIcon(width: number, height: number, model: IconColorModel = 'rgba'): Icon{\n        const icon = {\n            width, height, model, data: new Uint8ClampedArray(width * height * 4)\n        };\n\n        return icon;\n    }\n\n    static newIconWithBg(width: number, height: number, color: Color): Icon{\n        const model: IconColorModel = 'rgba';\n        const icon = {\n            width, height, model, data: new Uint8ClampedArray(width * height * 4)\n        };\n\n        for (let i = 0; i < icon.data.length; i += 4){\n            icon.data[i] = color.r;\n            icon.data[i + 1] = color.g;\n            icon.data[i + 2] = color.b;\n            icon.data[i + 3] = color.a * 255;\n        }\n\n        return icon;\n    }\n\n    static pixelToData(pixel: Point, icon: Icon): number{\n        return icon.width * 4 * pixel.y + pixel.x * 4;\n    }\n\n    static region32(icon: Icon, region: Rectangle, onPixel: (regionIndex: number, iconIndex: number) => void){\n        let current = 0;\n        for(let y = region.top; y < region.bottom; y++){\n            for(let x = region.left; x < region.right; x++){\n                const index = IconService.pixelToData(makePt(x,y), icon);\n                onPixel(index, current);\n                current += 4;\n            }\n        }\n    }\n\n    static blend(base: Icon, sprite: Icon, region: Rectangle, spriteOffset? : Point): Icon {\n\n        if (region.width > sprite.width || region.height > sprite.height){\n            throw new InvalidRegionError();\n        }\n\n        if (!spriteOffset){\n            spriteOffset = makePt(0, 0)\n        }\n\n        const buffer = this.clone(base);\n        const sourceOver = (s: number, d: number, sA: number) => d + s * (255 - sA);\n        const blend = sourceOver;\n\n        for (let y = 0; y < region.height; y++){\n            for(let x = 0; x < region.width; x++){\n                const baseIndex = this.pixelToData(makePt(region.left + x, region.top + y), base);\n                const spriteIndex = this.pixelToData(makePt(x + spriteOffset.x, y + spriteOffset.y), sprite);\n                const baseR = buffer.data[baseIndex];\n                const baseG = buffer.data[baseIndex + 1];\n                const baseB = buffer.data[baseIndex + 2];\n                const baseA = buffer.data[baseIndex + 3];\n                const spR = sprite.data[spriteIndex];\n                const spG = sprite.data[spriteIndex + 1];\n                const spB = sprite.data[spriteIndex + 2];\n                const spA = sprite.data[spriteIndex + 3];\n\n                buffer.data[baseIndex] = blend(baseR, spR, spA);\n                buffer.data[baseIndex + 1] = blend(baseG, spG, spA);\n                buffer.data[baseIndex + 2] = blend(baseB, spB, spA);\n                buffer.data[baseIndex + 3] = Math.max(baseA, spA);\n\n                // Hack note: this is not good alpha compositing\n                // In the future this should be better.\n            }\n        }\n\n        return buffer;\n    }\n}","import {FileError, InvalidImageError, MemoryError} from \"./errors\";\nimport {makeSz, scaleToContain, Size} from \"../hui/helpers/Rectangle\";\n\nconst REDUCE_MARGIN = 256;\n\nexport class ImageService{\n\n    static fromFile(file: Blob): Promise<HTMLImageElement>{\n        return new Promise<HTMLImageElement>((resolve, reject) => {\n\n            const reader = new FileReader();\n\n            reader.addEventListener('load', readEvent => {\n\n                if (readEvent.target){\n                    const img = new Image();\n\n                    img.addEventListener('load', () => resolve(img));\n                    img.addEventListener('error', () => reject(new InvalidImageError()));\n\n                    img.src = readEvent.target.result as string;\n                }else{\n                    reject(new MemoryError());\n                }\n\n            });\n\n            reader.addEventListener('error', () => reject(new FileError()));\n\n            reader.readAsDataURL(file);\n\n        });\n\n    }\n\n    static resize(image: HTMLImageElement, size: Size): Uint8ClampedArray{\n\n        const mustReduce = image.width > REDUCE_MARGIN || image.height > REDUCE_MARGIN;\n        const reducedSize = mustReduce ? scaleToContain(makeSz(REDUCE_MARGIN, REDUCE_MARGIN), size) : size;\n        const canvas: HTMLCanvasElement = document.createElement('canvas');\n        const cx = canvas.getContext('2d');\n\n        if (!cx){\n            throw new MemoryError();\n        }\n\n        canvas.width = reducedSize.width;\n        canvas.height = reducedSize.height;\n        cx.drawImage(image, 0, 0, reducedSize.width, reducedSize.height);\n\n        const imageData = cx.getImageData(0,0, reducedSize.width, reducedSize.height);\n\n        if (size.width <= REDUCE_MARGIN || size.height <= REDUCE_MARGIN){\n            return this.resample(imageData, size);\n        }else{\n            return imageData.data;\n        }\n\n    }\n\n    static resample(image: ImageData, size: Size): Uint8ClampedArray{\n        const srcW = image.width;\n        const srcH = image.height;\n        const destW = Math.round(size.width);\n        const destH = Math.round(size.height);\n        let data = image.data;\n        let data2 = new Uint8ClampedArray(size.width * size.height * 4);\n        let ratio_w = srcW / destW;\n        let ratio_h = srcH / destH;\n        let ratio_w_half = Math.ceil(ratio_w/2);\n        let ratio_h_half = Math.ceil(ratio_h/2);\n\n        for(let j = 0; j < destH; j++){\n            for(let i = 0; i < destW; i++){\n                let x2 = (i + j*destW) * 4;\n                let weight = 0;\n                let weights = 0;\n                let weights_alpha = 0;\n                let gx_r = 0, gx_g = 0, gx_b = 0, gx_a = 0;\n                let center_y = (j + 0.5) * ratio_h;\n                for(let yy = Math.floor(j * ratio_h); yy < (j + 1) * ratio_h; yy++){\n                    let dy = Math.abs(center_y - (yy + 0.5)) / ratio_h_half;\n                    let center_x = (i + 0.5) * ratio_w;\n                    let w0 = dy*dy; //pre-calc part of w\n                    for(let xx = Math.floor(i * ratio_w); xx < (i + 1) * ratio_w; xx++){\n                        let dx = Math.abs(center_x - (xx + 0.5)) / ratio_w_half;\n                        let w = Math.sqrt(w0 + dx*dx);\n                        if(w >= -1 && w <= 1){\n                            //hermite filter\n                            weight = 2 * w*w*w - 3*w*w + 1;\n                            if(weight > 0){\n                                dx = 4*(xx + yy*srcW);\n                                //alpha\n                                gx_a += weight * data[dx + 3];\n                                weights_alpha += weight;\n                                //colors\n                                if(data[dx + 3] < 255)\n                                    weight = weight * data[dx + 3] / 250;\n                                gx_r += weight * data[dx];\n                                gx_g += weight * data[dx + 1];\n                                gx_b += weight * data[dx + 2];\n                                weights += weight;\n                            }\n                        }\n                    }\n                }\n                data2[x2]     = gx_r / weights;\n                data2[x2 + 1] = gx_g / weights;\n                data2[x2 + 2] = gx_b / weights;\n                data2[x2 + 3] = gx_a / weights_alpha;\n            }\n        }\n        return data2;\n    }\n\n}","export class InvalidImageError extends Error{}\nexport class FileError extends Error{}\nexport class InvalidRegionError extends Error{}\nexport class MemoryError extends Error{}\nexport class NoSelectionError extends Error{}\nexport class NoClipboardAccessError extends Error{}","import {PencilTool} from \"./PencilTool\";\nimport {IconCanvasController} from \"../IconCanvasController\";\nimport {Color} from \"../../hui/helpers/Color\";\n\nexport class EraserTool extends PencilTool{\n\n    constructor(controller: IconCanvasController) {\n        super(controller);\n\n        this.color = Color.transparent;\n    }\n\n}","import {IconEditorTool} from \"../IconEditor\";\nimport {PointingEvent, PointingEventResult} from \"../../components/CanvasView\";\nimport {IconCanvasController} from \"../IconCanvasController\";\nimport {Point} from \"../../hui/helpers/Rectangle\";\nimport {Color} from \"../../hui/helpers/Color\";\n\nexport class PencilTool implements IconEditorTool{\n\n    private drawing = false;\n    color: Color = new Color(0,0,0,);\n\n    constructor(readonly controller: IconCanvasController) {}\n\n    private drawAt(p: Point){\n\n        const index = this.controller.pointToData(p);\n\n        if (index < 0){\n            return;\n        }\n\n\n        const newState = this.controller.editor.cloneDocument();\n        const data = newState.icon.data;\n\n        data[index    ] = this.color.r;\n        data[index + 1] = this.color.g;\n        data[index + 2] = this.color.b;\n        data[index + 3] = Math.round(this.color.a * 255);\n\n        this.controller.editor.setDocument(newState);\n\n    }\n\n    pointingGestureStart(e: PointingEvent): PointingEventResult | void {\n\n        this.drawing = true;\n\n        if (!this.controller.editor.currentTransaction){\n            this.controller.editor.begin();\n            this.drawAt(e.point);\n        }\n\n    }\n\n    pointingGestureMove(e: PointingEvent): PointingEventResult | void {\n\n        if (this.drawing){\n            this.drawAt(e.point);\n        }\n\n    }\n\n    pointingGestureEnd(e: PointingEvent): PointingEventResult | void {\n\n        this.drawing = false;\n        this.controller.editor.commit();\n\n    }\n\n}","import {IconDocument, IconEditor, IconEditorTool} from \"../IconEditor\";\nimport {KeyEvent, KeyEventResult, PointingEvent, PointingEventResult} from \"../../components/CanvasView\";\nimport {makePt, makeSz, Point, Rectangle} from \"../../hui/helpers/Rectangle\";\nimport {IconCanvasController} from \"../IconCanvasController\";\nimport {Icon} from \"../Icon\";\nimport {IconService} from \"../IconService\";\nimport {NoSelectionError} from \"../errors\";\n\nexport class SelectionTool implements IconEditorTool{\n\n    private selecting = false;\n    private dragging = false;\n    private dragOffset: Point = makePt(0, 0);\n    private startPixel = makePt(0,0);\n\n    readonly editor: IconEditor;\n\n    constructor(readonly controller: IconCanvasController) {\n        this.editor = controller.editor;\n    }\n\n    private clipOutSelection(document?: IconDocument): {buffer: Icon, sprite: Icon}{\n\n        if(!document){\n            document = this.document;\n        }\n\n        if (!document.selectionRegion){\n            throw new Error();\n        }\n\n        const buffer = IconService.clone(document.icon);\n        const sprite = IconService.fromIcon(buffer, document.selectionRegion);\n\n        IconService.region32(buffer, document.selectionRegion,\n            (index, current) => {\n                buffer.data[index] = 0\n                buffer.data[index + 1] = 0\n                buffer.data[index + 2] = 0\n                buffer.data[index + 3] = 0\n        });\n\n        return {buffer, sprite};\n    }\n\n    private updateSelRegion(a: Point, b: Point){\n        const newDoc = this.editor.cloneDocument();\n\n        newDoc.selectionRegion = Rectangle.fromLTRB(\n            Math.round(Math.min(a.x, b.x)),\n            Math.round(Math.min(a.y, b.y)),\n            Math.round(Math.max(a.x, b.x)) + 1,\n            Math.round(Math.max(a.y, b.y)) + 1\n        );\n\n        this.editor.setDocument(newDoc);\n    }\n\n    private selectionEnded(){\n\n        if (!this.document.selectionRegion || this.document.selectionRegion.isEmpty){\n            return;\n        }\n\n        const {buffer, sprite} = this.clipOutSelection();\n\n        this.editor.setDocument({\n            ...this.editor.cloneDocument(),\n            selectionBuffer: buffer,\n            selectionSprite: sprite,\n        });\n\n        this.selecting = false;\n    }\n\n    private pixelIsInsideSelection(p: Point | null){\n        return p && this.document.selectionRegion && this.document.selectionRegion.contains(p);\n    }\n\n    private dragEnded(){\n        this.dragging = false;\n        this.dragOffset = makePt(0,0);\n    }\n\n    private updateDrag(p: Point){\n\n        this.moveSelection(p.x - this.dragOffset.x, p.y - this.dragOffset.y);\n\n    }\n\n    private moveSelection(x: number, y: number){\n\n        if(\n            !this.document.selectionRegion ||\n            !this.document.selectionSprite ||\n            !this.document.selectionBuffer\n        ){\n            throw new NoSelectionError();\n        }\n\n        const base = this.document.icon;\n        const buffer: Icon = this.document.selectionBuffer;\n        const sprite: Icon = this.document.selectionSprite;\n\n        x = Math.max(-sprite.width, x);\n        x = Math.min(base.width, x);\n        y = Math.max(-sprite.height, y);\n        y = Math.min(base.height, y);\n\n        const region = new Rectangle(x, y, sprite.width, sprite.height);\n        const offset = makePt(\n            region.left < 0 ? Math.abs(region.left) : 0,\n            region.top < 0 ? Math.abs(region.top) : 0\n        );\n        const selectionRegion = Rectangle.fromLTRB(\n            region.left < 0 ? 0 : region.left,\n            region.top < 0 ? 0 : region.top,\n            region.right > base.width ? base.width : region.right,\n            region.bottom > base.height ? base.height : region.bottom\n        );\n        const icon = IconService.blend(buffer, sprite, selectionRegion, offset);\n        const newDoc: IconDocument = {\n            ...this.editor.cloneDocument(),\n            selectionRegion,\n            icon\n        };\n\n        if (this.editor.currentTransaction){\n            this.editor.setDocument(newDoc);\n        }else{\n            this.editor.transact(newDoc);\n        }\n\n    }\n\n    private offsetSelection(x: number, y: number){\n        if(\n            !this.document.selectionRegion ||\n            !this.document.selectionSprite\n        ){\n            throw new NoSelectionError();\n        }\n\n        const sprite: Icon = this.document.selectionSprite;\n        const current: Rectangle = this.document.selectionRegion;\n\n        let implicitX = current.right - sprite.width;\n        let implicitY = current.bottom - sprite.height;\n\n        implicitX = implicitX < 0 ? implicitX : 0;\n        implicitY = implicitY < 0 ? implicitY : 0;\n\n        this.moveSelection(current.left + x + implicitX, current.top + y + implicitY);\n\n    }\n\n    private saveDragOffset(p: Point){\n\n        if (!this.document.selectionRegion){\n            throw new NoSelectionError();\n        }\n\n        this.dragOffset = makePt(\n            p.x - this.document.selectionRegion.left,\n            p.y - this.document.selectionRegion.top\n        );\n    }\n\n    selectRegion(selectionRegion: Rectangle){\n        const icon = this.document.icon;\n        const doc: IconDocument = {\n            ...this.editor.cloneDocument(),\n            selectionRegion: Rectangle.fromSize(makeSz(icon.width, icon.height))\n        };\n\n        const {buffer, sprite} = this.clipOutSelection(doc);\n\n        this.editor.transact({\n            ...doc,\n            selectionBuffer: buffer,\n            selectionSprite: sprite,\n        });\n    }\n\n    selectAll(){\n        const icon = this.document.icon;\n        this.selectRegion(Rectangle.fromSize(makeSz(icon.width, icon.height)));\n    }\n\n    clearSelection(){\n        const newDoc = this.editor.cloneDocument();\n\n        newDoc.selectionRegion = newDoc.selectionSprite = newDoc.selectionBuffer = undefined;\n\n        this.editor.begin();\n        this.editor.setDocument(newDoc);\n        this.editor.commit();\n\n    }\n\n    deactivate(){\n        if (this.document.selectionRegion){\n            this.clearSelection();\n        }\n    }\n\n    deleteSelection(){\n\n        const newDoc = this.editor.cloneDocument();\n\n        newDoc.icon = newDoc.selectionBuffer!;\n        newDoc.selectionSprite = newDoc.selectionBuffer = newDoc.selectionRegion = undefined;\n\n        this.editor.begin();\n        this.editor.setDocument(newDoc);\n        this.editor.commit();\n    }\n\n    pointingGestureStart(e: PointingEvent): PointingEventResult | void{\n\n        const p = this.controller.pointToPixel(e.point);\n\n        if (p){\n            this.startPixel = p;\n            this.editor.begin();\n\n            if (this.pixelIsInsideSelection(p)){\n                this.dragging = true;\n                this.saveDragOffset(p);\n\n            }else{\n                this.selecting = true;\n\n            }\n        }\n\n    }\n\n    pointingGestureEnd(e: PointingEvent): PointingEventResult | void {\n\n        const p = this.controller.pointToPixel(e.point);\n\n        if (this.selecting){\n            this.selectionEnded();\n        }\n\n        if (this.dragging){\n            this.dragEnded();\n        }\n\n        if (this.editor.currentTransaction){\n            this.editor.commit();\n        }\n\n        if (this.pixelIsInsideSelection(p)){\n            return {cursor: 'move'};\n        }\n\n    }\n\n    pointingGestureMove(e: PointingEvent): PointingEventResult | void {\n\n        const p = this.controller.pointToPixel(e.point);\n\n        if (p){\n\n            if (this.selecting) {\n                this.updateSelRegion(this.startPixel, p);\n\n            }else if(this.dragging){\n                this.updateDrag(p);\n\n            }else if(this.pixelIsInsideSelection(p)){\n                return {cursor: 'move'};\n            }\n\n        }\n\n        return {cursor: 'crosshair'};\n    }\n\n    keyDown(e: KeyEvent): KeyEventResult | void {\n\n        if (e.key == 'Escape'){\n            this.clearSelection();\n\n        }else if (e.key == 'Delete' || e.key == 'Backspace'){\n            this.deleteSelection();\n\n        }else if (e.key == 'ArrowLeft'){\n            this.offsetSelection(-1, 0);\n\n        }else if (e.key == 'ArrowRight'){\n            this.offsetSelection(1, 0);\n\n        }else if (e.key == 'ArrowUp'){\n            this.offsetSelection(0, -1);\n\n        }else if (e.key == 'ArrowDown'){\n            this.offsetSelection(0, 1);\n\n        }\n\n    }\n\n    get document(): IconDocument{\n        return this.editor.document;\n    }\n\n}","module.exports = React;","module.exports = ReactDOM;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => module['default'] :\n\t\t() => module;\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/dist/\";","// startup\n// Load entry module\n// This entry module is referenced by other modules so it can't be inlined\n__webpack_require__(2629);\n"],"sourceRoot":""}